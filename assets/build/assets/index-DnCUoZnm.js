import{j as e,u as s,a as T}from"./fields-B4O9Q4Yk.js";import{a as g,u as U,R as N,L as D,d as V}from"./vendor-BwziPlmK.js";import{n as A,B as _,L as $,s as X}from"./Layout-Cn7fGwLD.js";import{P as b,u as M,f as R,B as E,s as h,n as H,l as S,w as P,A as v,a as W,m as z,c as Z,L as J}from"./index-DIgvZvNa.js";import{B as K}from"./index-oBSPYE0D.js";import{M as C}from"./index-D2c1mKCA.js";import{u as O,a as I,b as Q,F as ee}from"./index.esm-Czmjla35.js";import{m as j}from"./metaTypes-DSJrX6O3.js";import{P as se}from"./index-C-SLOP4R.js";import{u as te}from"./index-tMNRH81H.js";const w=({page:t,id:d})=>{const l=document.globals.settings,{reset:a}=O(),i=M(),c=l.length>0&&R(l,"key","records_per_page")!==""?R(l,"key","records_per_page").value:20,[x,r]=g.useState(!1),n=U(),o=()=>{i(H(d)).then(f=>{const k=f.payload;k.success?(a(),n("/meta"),r(!x),A.success(s("Meta group successfully deleted.")),i(S({page:t||1,perPage:c}))):A.error(k.error)}).catch(f=>console.error(f))},y=[e.jsx(E,{style:h.DANGER,onClick:()=>{o()},children:s("Yes, delete it")}),e.jsx(E,{style:h.SECONDARY,onClick:()=>{r(!x)},children:s("Return back to list")})];return e.jsxs(N.Fragment,{children:[e.jsx(C,{title:s("Delete meta group"),buttons:y,visible:x,children:e.jsx("div",{children:s("You are going to delete this meta group. Are you sure?")})}),e.jsx("a",{href:"#",onClick:f=>{f.preventDefault(),r(!x)},children:s("Delete")})]})};w.propTypes={page:b.number.isRequired,id:b.string.isRequired};const F=({belongsTo:t,find:d})=>{const[p,l]=g.useState(d);let a=h.SECONDARY;return(t===j.TAXONOMY||t==="TERM_ID")&&(a=h.WARNING),t===j.OPTION_PAGE&&(a=h.INFO),t===j.COMMENT&&(a=h.BORDERED),t==="USER_ID"&&(a=h.DANGER),(t==="POST_ID"||t==="POST_TAX"||t==="POST_CAT"||t==="POST_TEMPLATE"||t==="TERM_ID"||t==="USER_ID")&&(()=>{P("fetchFindAction",{belongsTo:t,id:d}).then(c=>{l(c)}).catch(c=>{console.error(c.message)})})(),t===j.USER?e.jsx(_,{style:h.DANGER,children:s("User")}):e.jsx(_,{style:a,children:p})};F.propTypes={belongsTo:b.string.isRequired,find:b.string.isRequired};const L=({belongs:t})=>{const p=document.globals.globals,[l,a]=g.useState(!1),i=r=>{if(!r.belongsTo)return"";let n="";switch(r.belongsTo){case j.CUSTOM_POST_TYPE:n="Custom post type";break;case j.TAXONOMY:n="Taxonomy";break;case j.USER:n="All users";break;case"POST_ID":n="Post";break;case"POST_TEMPLATE":n="Post template";break;case"POST_TAX":n="Post taxonomy";break;case"POST_CAT":n="Post category";break;case"TERM_ID":n="Term";break;case"USER_ID":n="User";break}return s(n)},c=r=>{if(!r.operator)return"";let n="";switch(r.operator){case"=":n="is equal to";break;case"!=":n="is not equal to";break;case"IN":n="is included in";break;case"NOT_IN":n="is not included in";break}return s(n)},x=r=>{if(!r.find||r.find==="")return"";const n=r.find.split(",");return n.length>0?e.jsx("div",{className:"i-flex-center flex-wrap s-4",children:n.map(o=>e.jsx(F,{belongsTo:r.belongsTo,find:o}))}):""};return e.jsxs(N.Fragment,{children:[e.jsx(C,{title:s("Location"),visible:l,textAlign:"left",children:t.length>0?e.jsx("div",{className:"responsive",children:e.jsx("table",{className:`acpt-table spaceless ${p.is_rtl?"rtl":""}`,children:e.jsx("tbody",{children:t.map((r,n)=>{const o=n===t.length-1;return e.jsxs("tr",{children:[e.jsx("td",{children:i(r)}),e.jsx("td",{children:c(r)}),e.jsx("td",{children:x(r)}),e.jsx("td",{children:!o&&r.logic&&s(r.logic)})]})})})})}):e.jsx(v,{style:h.SECONDARY,children:s("No conditions are present.")})}),e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),a(!l)},children:s("Show")})]})};L.propTypes={belongs:b.array.isRequired};const B=g.memo(({record:t,page:d})=>{const{register:p}=O(),l=`elements.${t.id}`,a=i=>{switch(i){default:case T.STANDARD:return s("Standard view");case T.ACCORDION:return s("Accordion");case T.HORIZONTAL_TABS:return s("Horizontal tabs");case T.VERTICAL_TABS:return s("Vertical tabs")}};return e.jsx(N.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:l,children:[e.jsx("input",{type:"checkbox",id:l,name:l,defaultChecked:!1,...p(l)}),e.jsx("span",{})]})}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.label}),e.jsx("td",{children:a(t.display)}),e.jsx("td",{children:e.jsx(L,{belongs:t.belongs})}),e.jsx("td",{children:t.fieldsCount}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(D,{to:`/edit_meta/${t.id}`,children:s("Edit")}),e.jsx(w,{id:t.id,page:d})]})})]})})});B.propTypes={page:b.number.isRequired,record:b.object.isRequired};const re=()=>{const{control:t,register:d}=O(),p=I({control:t,name:"elements"}),l=()=>{let a=0;for(const[i,c]of Object.entries(p))c===!0&&a++;return a};return e.jsxs("div",{className:"flex-between s-8 mb-24",children:[e.jsxs("span",{children:[l()," ",s("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{name:"action",className:"form-control sm",...d("action"),children:[e.jsx("option",{value:"",children:s("Select")}),e.jsx("option",{value:"delete",children:s("Delete")})]}),e.jsx(E,{style:h.WHITE,size:"sm",children:s("Execute")})]})]})},ne=()=>{const t=document.globals,d=t.settings,p=t.globals,[l]=te(),a=g.useRef(),i=Q({mode:"all"}),c=I({control:i.control,name:"elements"}),x=M(),{data:r,loading:n}=W(u=>u.fetchMeta),{page:o}=V(),y=d.length>0&&R(d,"key","records_per_page")!==""?R(d,"key","records_per_page").value:20,f=Math.ceil(r.count/y);g.useEffect(()=>{z(s("Field groups")),Z("#/meta"),x(S({page:o||1,perPage:y}))},[o]),g.useEffect(()=>{(()=>{if(!c)return!1;let m=0;for(const[ae,Y]of Object.entries(c))Y===!0&&m++;return m===Object.entries(c).length})()?a.current.checked=!0:a.current&&(a.current.checked=!1)},[c]);const k=()=>{if(!c)return!1;for(const[u,m]of Object.entries(c))if(m===!0)return!0;return!1},G=u=>{i.reset(),u.belongsTo=j.META,P("bulkActionsAction",u).then(m=>{if(m.success===!0)switch(u.action){case"delete":A.success(s("Meta group successfully deleted.")),i.resetField("elements"),X(),x(S({page:o||1,perPage:y}));break}else A.error(m.error)}).catch(m=>{console.error(m),A.error(s("Unknown error, please retry later"))})},q=[e.jsx(K,{style:h.PRIMARY,to:"/register_meta",children:s("Create new Meta group")})];return n?e.jsx(J,{}):e.jsx(ee,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(G),children:e.jsxs($,{title:s("Field groups"),actions:q,crumbs:[{label:s("Field groups")}],children:[e.jsx("div",{ref:l,children:k()&&e.jsx(re,{})}),r.records&&r.records.length>0?e.jsx("div",{className:"responsive",children:e.jsxs("table",{className:`acpt-table with-shadow ${p.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"all",children:[e.jsx("input",{ref:a,type:"checkbox",id:"all",defaultChecked:!1,onClick:u=>{r.records.map(m=>{i.setValue(`elements.${m.id}`,u.currentTarget.checked)})}}),e.jsx("span",{})]})}),e.jsx("th",{children:s("Group name")}),e.jsx("th",{children:s("Group label")}),e.jsx("th",{children:s("Display as")}),e.jsx("th",{children:s("Location")}),e.jsx("th",{children:s("Fields count")}),e.jsx("th",{children:s("Actions")})]})}),e.jsx("tbody",{children:r.records&&r.records.map(u=>e.jsx(B,{page:o,record:u},u.id))}),f>1&&e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:e.jsx(se,{currentPage:o?parseInt(o):1,totalPages:f,baseLink:"/meta"})})})})]})}):e.jsxs(v,{style:h.SECONDARY,children:[s("No meta group found.")," ",e.jsx(D,{to:"/register_meta",children:s("Register the first one")}),"!"]})]})})})};ne.propTypes={};export{ne as default};
