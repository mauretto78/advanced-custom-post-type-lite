import{j as e,f as j}from"./fields-B4O9Q4Yk.js";import{R as y}from"./vendor-BwziPlmK.js";import{m as h}from"./metaTypes-DSJrX6O3.js";const C=()=>{let t=!1;if(typeof _<"u"&&typeof _.forEach=="function"){const n=["get","set","at","cloneDeep"];t=!0,n.forEach(function(l){t=typeof _[l]!="function"?!1:t})}return!!t},w=({attributes:t,setAttributes:n})=>{const{__:l}=wp.i18n,{PanelRow:c,SelectControl:o}=wp.components;return e.jsx(c,{children:e.jsx(o,{label:l("Display as","acpt"),value:t.display,options:[{label:l("text","acpt"),value:l("text","acpt")},{label:l("link","acpt"),value:l("link","acpt")}],onChange:i=>{n({...t,display:i})}})})},k=({attributes:t,setAttributes:n})=>{const{__:l}=wp.i18n,{PanelRow:c,SelectControl:o}=wp.components,i=[{label:l("--Select---","acpt"),value:null},{value:"d-M-y",label:"dd-mmm-yy (ex. 28-OCT-90)"},{value:"d-M-Y",label:"dd-mmm-yyyy (ex. 28-OCT-1990)"},{value:"d M y",label:"mmm yy (ex. 28 OCT 90)"},{value:"d M Y",label:"mmm yyyy (ex. 28 OCT 1990)"},{value:"d/m/Y",label:"dd/mm/yy (ex. 28/10/90)"},{value:"d/m/Y",label:"dd/mm/yyyy (ex. 28/10/1990)"},{value:"m/d/y",label:"mm/dd/yy (ex. 10/28/90)"},{value:"m/d/Y",label:"mm/dd/yyyy (ex. 10/28/1990)"},{value:"d.m.Y",label:"dd.mm.yy (ex. 28.10.90)"},{value:"d.m.Y",label:"dd.mm.yyyy (ex. 28.10.1990)"}];return e.jsx(c,{children:e.jsx(o,{label:l("Select date format","acpt"),value:t.dateFormat,options:i,onChange:a=>{n({...t,dateFormat:a})}})})},L=({fields:t,attributes:n,setAttributes:l})=>{const{__:c}=wp.i18n,{PanelRow:o,SelectControl:i}=wp.components,a=n.field?JSON.parse(n.field):null;return a&&a.block_name?e.jsx(y.Fragment,{children:e.jsx(o,{children:e.jsxs("div",{className:"acpt-inline-block",children:[e.jsx("span",{className:"acpt-badge acpt-badge-primary",children:a.parent_field}),e.jsx("span",{className:"acpt-badge acpt-badge-success",children:a.block_name}),e.jsx("span",{className:"acpt-badge acpt-badge-success-outline",children:a.block_index}),e.jsx("span",{className:"acpt-badge acpt-badge-secondary-outline",children:a.field}),e.jsx("span",{className:"acpt-badge acpt-badge-secondary-outline",children:a.index})]})})}):a&&a.parent_field?e.jsx(y.Fragment,{children:e.jsx(o,{children:e.jsxs("div",{className:"acpt-inline-block",children:[e.jsx("span",{className:"acpt-badge acpt-badge-primary",children:a.parent_field}),e.jsx("span",{className:"acpt-badge acpt-badge-secondary-outline",children:a.field}),e.jsx("span",{className:"acpt-badge acpt-badge-secondary-outline",children:a.index})]})})}):a?e.jsx(y.Fragment,{children:e.jsx(o,{children:e.jsx("div",{className:"acpt-inline-block",children:e.jsx("span",{className:"acpt-badge acpt-badge-secondary-outline",children:a.label})})})}):e.jsx(y.Fragment,{children:e.jsx(o,{children:e.jsx(i,{label:c("Field","acpt"),value:n.field,options:t,onChange:d=>l({...n,field:d})})})})},T=({attributes:t,setAttributes:n,context:l})=>{const{__:c}=wp.i18n,{useBlockProps:o,InspectorControls:i,BlockControls:a,AlignmentControl:d}=wp.blockEditor,p=wp.serverSideRender,{Panel:s,PanelBody:m}=wp.components,f=o(),u=t.field?JSON.parse(t.field):null;return e.jsxs("div",{...f,children:[e.jsx(a,{children:e.jsx(d,{value:t.align,onChange:r=>n({...t,align:r})})}),e.jsx(i,{children:e.jsxs(s,{children:[e.jsx(m,{title:c("General settings","acpt"),initialOpen:!0,children:e.jsx(L,{fields:document.metaFields.filter(r=>r.group==="all"||r.group==="basic"||r.group==="media"),attributes:t,setAttributes:n})}),e.jsxs(m,{title:c("Advanced settings","acpt"),initialOpen:!0,children:[u&&u.type===j.EMAIL&&e.jsx(w,{attributes:t,setAttributes:n}),u&&u.type===j.DATE&&e.jsx(k,{attributes:t,setAttributes:n})]})]})}),e.jsx(p,{block:"advanced-custom-post-type/basic-block",attributes:{...t,...l}})]})},g=async(t,n)=>{let l;return l=n instanceof FormData?n:new FormData,l.append("action",t),l.append("data",JSON.stringify(n)),await(await fetch(typeof ajaxurl=="string"?ajaxurl:"/wp-admin/admin-ajax.php",{method:"POST",body:l})).json()};wp.i18n;const O=async()=>{let t=[];if(pagenow==="site-editor"){let n=await g("fetchAllMetaAction",{gutenberg:!0});for(const[l,c]of Object.entries(n))for(const[o,i]of Object.entries(c))i.length>0&&t.push({belongsTo:l,find:o,records:i})}else if(typenow!==""){let n=await g("fetchMetaAction",{belongsTo:h.CUSTOM_POST_TYPE,find:typenow});t.push({belongsTo:h.CUSTOM_POST_TYPE,find:typenow,records:n.records});let l=await g("fetchOptionPagesMetaAction",{page:pagenow});for(const[c,o]of Object.entries(l))t.push({belongsTo:h.OPTION_PAGE,find:c,records:o})}return t},P=async()=>{let t=await g("fetchAllFindBelongsAction",{});document.globals.globals=t},S=e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 634 572",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M465.039 115.5L339.505 42.9755C333.314 39.3991 325.686 39.3991 319.495 42.9755L193.961 115.5L319.495 188.024C325.686 191.601 333.314 191.601 339.505 188.024L465.039 115.5ZM359.515 8.34015C340.943 -2.3891 318.057 -2.3891 299.485 8.34015L114 115.5L299.485 222.66C318.057 233.389 340.943 233.389 359.515 222.66L545 115.5L359.515 8.34015Z",fill:"#000"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M520.34 209.498L394.765 281.952C388.572 285.524 384.758 292.131 384.76 299.28L384.801 444.258L510.376 371.805C516.568 368.232 520.383 361.625 520.381 354.476L520.34 209.498ZM374.775 247.305C356.197 258.024 344.754 277.844 344.76 299.292L344.82 513.507L530.366 406.452C548.944 395.733 560.387 375.913 560.381 354.465L560.32 140.25L374.775 247.305Z",fill:"#000"}),e.jsx("path",{opacity:"0.5",fillRule:"evenodd",clipRule:"evenodd",d:"M275.34 444.259L275.381 299.281C275.383 292.131 271.568 285.525 265.376 281.952L139.801 209.498L139.76 354.476C139.758 361.625 143.572 368.232 149.765 371.805L275.34 444.259ZM315.381 299.292C315.387 277.844 303.944 258.024 285.366 247.305L99.8202 140.25L99.7599 354.465C99.7538 375.913 111.197 395.733 129.775 406.452L315.32 513.507L315.381 299.292Z",fill:"#000"})]}),{__:b}=wp.i18n,{registerBlockType:F}=wp.blocks,{useBlockProps:M,InnerBlocks:D}=wp.blockEditor;C()&&_.noConflict();P();const R=async()=>{let t=[{value:null,label:b("--Select---","acpt"),group:"all"}];return O().then(n=>{n.map(l=>{const c=l.records,o=l.belongsTo,i=l.find?l.find:null,a=(d,p,s,m=null)=>{let f=[],u=[];return s.blocks&&s.blocks.map(r=>{let x={name:r.name,fields:[]};r.fields&&r.fields.map(v=>{x.fields.push(a(d,p,v,s))}),f.push(x)}),s.children&&s.children.map(r=>{u.push(a(d,p,r,s))}),{group:d,value:i+"_"+s.db_name,label:"["+i+"] - "+s.ui_name,box:p.name,field:s.name,type:s.type,belongsTo:o,find:i,relations:s.relations.length>0?{relationship:s.relations[0].relationship,from:s.relations[0].from,to:s.relations[0].to}:null,parent_field:m?m.name:null,blocks:f,children:u}};c.length>0&&c.map(d=>{d.boxes.length>0&&d.boxes.map(p=>{p.fields&&p.fields.map(s=>{t.push({label:"["+i+"] - "+s.ui_name,group:s.group,value:JSON.stringify(a(d.name,p,s))})})})})})}),t},N=t=>{document.metaFields=t,wp.blocks.updateCategory("advanced-custom-post-type-blocks",{icon:S}),F("advanced-custom-post-type/basic-block",{apiVersion:3,title:b("ACPT Basic fields","acpt"),description:b("Include an ACPT basic field.","acpt"),icon:"block-default",category:"advanced-custom-post-type-blocks",textdomain:"advanced-custom-post-type",usesContext:["postId"],supports:{color:{gradients:!0},typography:{fontSize:!0},spacing:{padding:!0,margin:!0}},attributes:{postId:{type:"integer",default:1e17},field:{type:"string",default:null},gradient:{type:"string",default:null},backgroundColor:{type:"string",default:null},textColor:{type:"string",default:null},style:{type:"object",default:{}},display:{type:"string",default:null},color:{type:"string",default:null},fontSize:{type:"string",default:null},target:{type:"string",default:null},width:{type:"string",default:null},height:{type:"string",default:null},uomFormatDecimalPoints:{type:"string",default:null},uomFormatDecimalSeparator:{type:"string",default:null},uomFormatThousandsSeparator:{type:"string",default:null},uomFormat:{type:"string",default:null},uomPosition:{type:"string",default:null},dateFormat:{type:"string",default:null},timeFormat:{type:"string",default:null},align:{type:"string",default:"left"},zoom:{type:"integer",default:14},gap:{type:"integer",default:20},elements:{type:"integer",default:3},border:{type:"object",default:{}},borderRadius:{type:"object",default:{}},padding:{type:"object",default:{}}},edit:T,save:n=>{const l=M.save();return e.jsx("div",{...l,children:n.attributes.content})}})};R().then(t=>{t.length>0&&N(t)});
