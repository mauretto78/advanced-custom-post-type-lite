import{j as e,u as t}from"./fields-PF-HBT_1.js";import{a as N,R as I,u as Ce,d as De}from"./vendor-Bd2ZL6QG.js";import{u as T,c as M,b as w,g as ee,a as Te,F as Se}from"./index.esm-VK9FF9DZ.js";import{u as S,B as D,s as y,ag as Fe,ah as se,P as f,ai as we,I as E,A as Re,E as U,aj as Ee,b as k,ak as te,al as le,am as ae,an as P,y as _,z as ke,ao as Ae,ap as Ie,a3 as qe,aq as Oe,aa as Me,m as Le,k as Pe,ar as Ve,as as $e,L as Ue,i as _e,at as Be}from"./index-DW5hxcvK.js";import{b as V,u as Z,B as We,L as Ge,n as $}from"./Layout-CWuy_X96.js";import{M as B}from"./index-DWASJDmz.js";import{P as Ye}from"./index-BtGLDHVG.js";import{I as W}from"./InputHidden-D-jbqkMN.js";import{u as ne}from"./index-BixwEkkR.js";import{u as G,C as Y,S as ie,M as re,B as He,L,a as ze}from"./index-Ch_nh8BR.js";import{S as de}from"./Select-B-i47g2p.js";import{I as q}from"./Input-Bruvbvt9.js";import{T as O}from"./index-BZHPcMFf.js";const Je=()=>{const s=S(),{setValue:r}=T(),[i,a]=N.useState(!1),n=[e.jsx(D,{style:y.SUCCESS,onClick:c=>{c.preventDefault(),s(Fe()),s(se()),r("fields",[]),a(!i)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:c=>{c.preventDefault(),a(!i)},children:t("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(B,{title:t("Confirm deleting all"),visible:i,buttons:n,children:t("Are you sure?")}),e.jsx(D,{style:y.DANGER,onClick:c=>{c.preventDefault(),a(!i)},children:t("Delete all")})]})},Xe="Checkbox",Ke="Color",Qe="Date",Ze="DateTime",es="Email",ss="Number",ts="Phone",ls="PostObject",as="PostObjectMulti",oe="Radio",ce="Select",ue="SelectMulti",ns="TermObject",is="TermObjectMulti",H="Text",rs="Textarea",ds="Time",os="Url",cs="User",us="UserMulti",me=[{value:H,label:"Text"},{value:Ke,label:"Color"},{value:Qe,label:"Date"},{value:Ze,label:"DateTime"},{value:es,label:"Email"},{value:ss,label:"Number"},{value:ts,label:"Phone"},{value:ds,label:"Time"},{value:os,label:"Url"},{value:rs,label:"Textarea"},{value:ce,label:"Select"},{value:ue,label:"Select (Multiple)"},{value:Xe,label:"Checkbox"},{value:oe,label:"Radio"},{value:ls,label:"Post object"},{value:as,label:"Post object (Multiple)"},{value:ns,label:"Term object"},{value:is,label:"Term object (Multiple)"},{value:cs,label:"User"},{value:us,label:"User (Multiple)"}],he=({fieldIndex:s,optionIndex:r})=>{const i=S(),a=()=>`fields.${s}.options`,{control:n}=T(),{remove:c}=M({control:n,name:a()}),[p,x]=N.useState(!1),l=[e.jsx(D,{style:y.SUCCESS,onClick:d=>{d.preventDefault(),i(we({fieldIndex:s,optionIndex:r})),c(r),x(!p)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:d=>{d.preventDefault(),x(!p)},children:t("No")})];return e.jsxs("span",{children:[e.jsx(B,{title:t("Confirm deleting option"),visible:p,buttons:l,children:t("Are you sure?")}),e.jsx("a",{href:"#",onClick:d=>{d.preventDefault(),x(!p)},children:e.jsx(O,{icon:!1,tip:t("Delete"),label:e.jsx(E,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};he.propTypes={fieldIndex:f.number.isRequired,optionIndex:f.number.isRequired};const pe=N.memo(({index:s,fieldIndex:r,fieldId:i,option:a})=>{const n=b=>`fields.${r}.options.${s}.${b}`,{register:c,formState:{errors:p},control:x,setValue:l}=T(),d=w({control:x,name:n("value")}),h=w({control:x,name:n("label")}),{attributes:g,listeners:u,setNodeRef:m,transform:o}=G({id:a.id}),j={transform:Y.Translate.toString(o)},[C,F]=N.useState(a.label===a.value),R=()=>d||(a.value?a.value:null),v=()=>h||(a.label?a.label:null);return e.jsxs("div",{className:"i-flex-center s-8",style:j,ref:m,children:[e.jsx(W,{id:n("id"),value:a.id,register:c}),e.jsx("span",{className:"cursor-move top-2 handle",...g,...u,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsxs("span",{className:"i-flex-center s-24 w-100",children:[e.jsx("span",{className:"w-100",children:e.jsx(q,{id:n("label"),register:c,errors:p,defaultValue:v(),onChangeCapture:b=>{C&&l(n("value"),b.target.value)},onClick:b=>{a.label&&b.target.value==="option"&&l(n("label"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("span",{children:e.jsx("button",{type:"button",className:`acpt-btn-switch ${C?"active":""}`,onClick:b=>{b.preventDefault(),F(!C)},children:e.jsx(E,{icon:"bx:bx-link",width:"18px"})})}),e.jsx("span",{className:"w-100",children:e.jsx(q,{id:n("value"),register:c,errors:p,defaultValue:R(),onChangeCapture:b=>{C&&l(n("label"),b.target.value)},onClick:b=>{a.value&&b.target.value==="option"&&l(n("value"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(he,{fieldIndex:r,optionIndex:s})]})]})});pe.propTypes={fieldId:f.string.isRequired,index:f.number.isRequired,fieldIndex:f.number.isRequired,option:f.object.isRequired};const xe=({fieldId:s,fieldIndex:r,options:i})=>{const a=S(),n=()=>`fields.${r}.options`,{control:c}=T(),{move:p}=M({control:c,name:n()}),x=d=>{const{active:h,over:g}=d;if(h.id===g.id)return;const u=i.findIndex(o=>o.id===h.id),m=i.findIndex(o=>o.id===g.id);p(u,m)},l=()=>{const d={id:U(),fieldId:s,label:"option",value:"option"};a(Ee({fieldIndex:r,option:d}))};return e.jsx("div",{children:e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:t("Option list")}),i&&i.length>0?e.jsx(ie,{onDragEnd:x,items:i,children:e.jsx("div",{className:"flex-column s-24",children:i&&i.map((d,h)=>e.jsx(pe,{index:h,fieldIndex:r,fieldId:s,option:d}))})}):e.jsx(Re,{style:y.WARNING,children:t('No options already created. Create the first one now by clicking the button "Add option"!')}),e.jsx("div",{className:"i-flex-center s-8 mt-24",children:e.jsx("a",{href:"#",onClick:d=>{d.preventDefault(),l()},children:t("Add option")})})]})})};xe.propTypes={fieldId:f.string.isRequired,fieldIndex:f.number.isRequired,options:f.array.isRequired};const z=({element:s})=>{const r=S(),{selectedElements:i}=k(n=>n.productDataFieldsState),a=()=>i.filter(c=>c.id===s.id).length>0;return e.jsx(O,{label:e.jsxs("label",{className:"checkbox",htmlFor:`select-${s.id}`,style:{top:"3px"},children:[e.jsx("input",{id:`select-${s.id}`,type:"checkbox",checked:a(),onChange:n=>{r(te({element:s,selected:n.target.checked}))}}),e.jsx("span",{})]}),icon:!1,tip:t(a()?"Deselect this element":"Select this element")})};z.propTypes={element:f.object.isRequired};const fe=({field:s,index:r})=>{const i=S(),{control:a}=T(),{remove:n}=M({control:a,name:"fields"}),[c,p]=N.useState(!1),x=[e.jsx(D,{style:y.SUCCESS,onClick:l=>{l.preventDefault(),i(le({field:s})),n(r),p(!c)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:l=>{l.preventDefault(),p(!c)},children:t("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(B,{title:t("Confirm deleting option"),visible:c,buttons:x,children:t("Are you sure?")}),e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),p(!c)},children:e.jsx(E,{icon:"bx-trash",width:18,color:"#F94144"})})]})};fe.propTypes={index:f.number.isRequired,field:f.object.isRequired};const J=({field:s,index:r})=>{const i=S(),{closedElements:a}=k(l=>l.productDataFieldsState),{control:n}=T(),{append:c}=M({control:n,name:"fields"}),p=()=>a.filter(d=>d===s.id).length===1,x=()=>{ke(s.id),p()?i(Ae({id:s.id})):i(Ie({id:s.id}))};return e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(O,{label:e.jsx("a",{href:"#",onClick:l=>{l.preventDefault();const d=ae(s);i(P({field:d})),c(d),_(1).then(()=>{V(d.id)})},children:e.jsx(E,{icon:"bx:duplicate",width:18})}),tip:t("Duplicate this meta field"),icon:!1}),e.jsx(O,{label:e.jsx(fe,{index:r,field:s}),tip:t("Delete this meta field"),icon:!1}),e.jsx(O,{label:e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),x()},children:e.jsx(E,{icon:"bx:expand-alt",width:18})}),tip:t("Hide/show this meta field"),icon:!1})]})};J.propTypes={index:f.number.isRequired,field:f.object.isRequired};const je=({field:s,index:r})=>{const{attributes:i,listeners:a,setNodeRef:n,isDragging:c,transform:p}=G({id:s.id}),x={transform:Y.Translate.toString(p)};S(),k(v=>v.productDataFieldsState);const{register:l,formState:{errors:d},control:h,setValue:g}=T(),u=v=>`fields.${r}.${v}`,m=w({control:h,name:u("name")}),o=w({control:h,name:u("type")}),j=w({control:h,name:u("isRequired")}),C=()=>{const v=u("name"),b=ee(d,v);return b?e.jsx("span",{className:"invalid-feedback",children:t(b.message)}):m||s.name},F=()=>o||s.type,R=v=>v===ce||v===ue||v===oe;return e.jsx("tr",{id:s.id,ref:n,style:x,className:`bg-white ${c?"b-rounded z-100 with-drop-shadow":""}`,children:e.jsxs("td",{style:{background:"#eff6fc3b"},className:"with-active-border",colSpan:4,children:[e.jsx(W,{id:u("id"),value:s.id,register:l}),e.jsx("div",{className:"mb-24",children:e.jsxs("div",{className:"flex-between s-8 for-xs",children:[e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...i,...a,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsx(z,{element:{id:s.id}}),e.jsx("h3",{children:C()}),e.jsx("span",{className:"color-gray",children:e.jsx(re,{fieldType:F(),css:"top-2"})}),e.jsx("span",{className:"i-flex-center s-8",children:e.jsx(O,{label:e.jsx(I.Fragment,{children:e.jsx(He,{control:h,defaultValue:typeof j=="boolean"?j:s.isRequired,errors:d,icon:"foundation:asterisk",id:u("isRequired")})}),tip:t("Field required"),icon:!1})})]}),e.jsx(J,{field:s,index:r})]})}),e.jsx("div",{className:"bg-white with-border b-rounded p-24",children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!0,id:u("name"),label:t("Name")}),e.jsx(q,{id:u("name"),register:l,errors:d,placeholder:t("Name"),defaultValue:s.name,onClick:v=>{s.name&&v.target.value==="field"&&g(u("name"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!0,id:u("type"),label:t("Field type")}),e.jsx(de,{register:l,errors:d,id:u("type"),values:me})]})]}),e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!1,id:u("defaultValue"),label:t("Default value")}),e.jsx(q,{id:u("defaultValue"),register:l,errors:d,placeholder:t("Default value"),defaultValue:s.defaultValue,validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!1,id:u("description"),label:t("A brief description")}),e.jsx(q,{id:u("description"),register:l,errors:d,placeholder:t("A brief description"),defaultValue:s.description,validate:{maxLength:{value:255,message:"max length is 255"}}})]})]}),R(F())&&e.jsx(xe,{fieldId:s.id,fieldIndex:r,options:s.options?s.options:[]})]})})]})})};je.propTypes={index:f.number.isRequired,field:f.object.isRequired};const be=({field:s,index:r})=>{const{attributes:i,listeners:a,setNodeRef:n,isDragging:c,transform:p}=G({id:s.id}),x={transform:Y.Translate.toString(p)};S(),k(A=>A.productDataFieldsState);const{register:l,formState:{errors:d},control:h,setValue:g}=T(),u=A=>`fields.${r}.${A}`,m=w({control:h,name:u("name")}),o=w({control:h,name:u("type")});w({control:h,name:u("isRequired")});const j=()=>{const A=u("name"),Q=ee(d,A);return Q?e.jsx("span",{className:"invalid-feedback",children:t(Q.message)}):m||s.name},C=()=>o||s.type,[F,R]=N.useState(!1),[v,b]=N.useState(!1),X=N.useRef(),K=N.useRef();return Z([X],()=>{b(!1)}),Z([K],()=>{R(!1)}),e.jsx(I.Fragment,{children:e.jsxs("tr",{id:s.id,ref:n,style:x,className:`bg-white b-rounded ${c?"z-100 with-drop-shadow":""}`,children:[e.jsx("td",{children:e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move handle top-2",...i,...a,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsx(z,{element:{id:s.id}})]})}),e.jsx("td",{children:F?e.jsx("div",{ref:K,style:{maxWidth:"200px"},children:e.jsx(q,{id:u("name"),register:l,errors:d,placeholder:t("Name"),defaultValue:s.name,onClick:A=>{s.name&&A.target.value==="field"&&g(u("name"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}):e.jsx("div",{className:"i-flex-center s-8 cursor-pointer",onClick:()=>{window.innerWidth>=960&&R(!F)},children:j()})}),e.jsx("td",{children:v?e.jsx("div",{ref:X,style:{maxWidth:"200px"},children:e.jsx(de,{register:l,id:u("type"),errors:d,defaultValue:s.type,values:me})}):e.jsx("div",{className:"i-flex-center s-8 cursor-pointer",onClick:()=>{window.innerWidth>=960&&b(!v)},children:e.jsx(re,{fieldType:C(),css:"with-border b-rounded p-8"})})}),e.jsx("td",{children:e.jsx(J,{field:s,index:r})})]})})};be.propTypes={index:f.number.isRequired,field:f.object.isRequired};const ve=({field:s,index:r})=>{const{closedElements:i}=k(n=>n.productDataFieldsState);return i.filter(c=>c===s.id).length===1?e.jsx(be,{field:s,index:r}):e.jsx(je,{field:s,index:r})};ve.propTypes={index:f.number.isRequired,field:f.object.isRequired};const ms=()=>{const s=S(),{selectedElements:r}=k(h=>h.productDataFieldsState),{control:i,setValue:a,getValues:n}=T(),c=w({control:i,name:"fields"}),p=N.useRef(null),[x,l]=N.useState(null),d=()=>{r.map(h=>{const g=c.findIndex(m=>m.id===h.id),u=c[g];switch(x){case"duplicate":const m=ae(u);c.push(m),a("fields",c),s(P({field:m}));break;case"delete":const o={...u},j=n("fields").filter(C=>C.id!==h.id);a("fields",j),s(le({field:o}));break}}),(x==="delete"||x==="duplicate")&&s(se()),p.current.value=""};return e.jsx(I.Fragment,{children:r.length>0&&e.jsxs("div",{className:"flex-between mb-24",children:[e.jsxs("div",{children:[r.length," ",t("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{ref:p,className:"form-control sm",onChange:h=>{l(h.target.value!==""?h.target.value:null)},children:[e.jsx("option",{value:"",children:t("Select")}),e.jsx("option",{value:"duplicate",children:t("Duplicate")}),e.jsx("option",{value:"delete",children:t("Delete")})]}),e.jsx(D,{style:y.WHITE,size:"sm",disabled:x===null,onClick:h=>{h.preventDefault(),d()},children:t("Execute")})]})]})})},ge=({field:s,index:r})=>{const{control:i}=T(),a=w({control:i,name:`fields.${r}.name`});return e.jsx(I.Fragment,{children:e.jsxs("div",{className:"tree-el flex-between s-8",style:{"--level":0},children:[e.jsx("span",{className:"text-ellipsis cursor-pointer",onClick:n=>{n.preventDefault(),V(`${s.id}`)},children:a||s.name}),e.jsx(We,{style:y.SECONDARY,children:"F"})]})})};ge.propTypes={field:f.object.isRequired,index:f.number.isRequired};const Ne=({fields:s})=>{const i=document.globals.globals;return s.length===0?null:e.jsxs("div",{className:"b-rounded with-shadow bg-white p-24",children:[e.jsx("h3",{className:"mb-24 flex-between s-8",children:e.jsx("span",{className:"text-ellipsis cursor-pointer",children:t("product data fields")})}),e.jsx("div",{className:`tree ${i.is_rtl===!0?"rtl":""}`,children:s.map((a,n)=>e.jsx(ge,{index:n,field:a}))})]})};Ne.propTypes={fields:f.array.isRequired};const ye=({fields:s})=>{const r=document.globals;r.settings;const i=r.globals,[a]=ne(),n=S(),{control:c}=T(),{move:p}=M({control:c,name:"fields"}),x="wp_product_data",[l,d]=N.useState(qe(x)),h=o=>{const{active:j,over:C}=o;if(j.id===C.id)return;const F=s.findIndex(b=>b.id===j.id),R=s.findIndex(b=>b.id===C.id),v=ze(s,F,R);p(F,R),n(Oe(v))},g=o=>{s&&s.map(j=>{n(te({element:j,selected:o}))})},u=()=>{const o=U();n(P({field:{id:o,name:"field",type:H,isRequired:!1,description:null,defaultValue:null,options:[]}})),_(1).then(()=>{V(o)})},m=o=>{Me(x,o),d(!l)};return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"flex-between s-8",children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("h3",{children:t("product data fields")}),e.jsx("span",{className:"px-8 py-4 font-sm bg-light-gray text-normal b-rounded",children:s.length>0?s.length:0})]}),s.length>0&&e.jsxs("div",{className:"i-flex-center s-8 mb-24",children:[e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{htmlFor:"toggle_navigation",className:"toggle",children:[e.jsx("input",{id:"toggle_navigation",type:"checkbox",checked:l,onChangeCapture:o=>{m(o.target.checked)}}),e.jsx("span",{className:"slider round"})]})}),e.jsx("label",{className:"cursor-pointer",htmlFor:"toggle_navigation",children:t(l?"Hide navigation":"Show navigation")})]})]}),e.jsx(ms,{}),s&&s.length>0?e.jsxs("div",{className:"container",children:[l&&e.jsx("div",{className:"col-3 flex-column s-24 hidden-xs sticky",style:{top:"130px"},children:e.jsx(Ne,{fields:s})}),e.jsx("div",{className:`flex-column s-24 ${l?"col-9":"col-12"}`,children:e.jsxs("div",{className:"responsive with-shadow b-rounded",children:[e.jsxs("table",{className:`acpt-table  ${i.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"select-fields",style:{marginLeft:"26px"},children:[e.jsx("input",{id:"select-fields",type:"checkbox",onChange:o=>{g(o.target.checked)}}),e.jsx("span",{})]})}),e.jsx("th",{children:t("Name")}),e.jsx("th",{children:t("Type")}),e.jsx("th",{children:t("Actions")})]})}),e.jsx("tbody",{ref:a,children:e.jsx(ie,{onDragEnd:h,items:s,children:s&&s.map((o,j)=>e.jsx(ve,{field:o,index:j}))})})]}),e.jsx("div",{className:"p-24 bg-white",children:e.jsx(D,{type:"button",style:y.SECONDARY,onClick:o=>{o.preventDefault(),u()},children:t("Add field")})})]})})]}):e.jsx("div",{className:"mb-24 p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:t('No fields already created. Create the first one now by clicking the button "Add field"!')}),e.jsx("div",{children:e.jsx(D,{type:"button",style:y.SECONDARY,onClick:o=>{o.preventDefault(),u()},children:t("Add field")})})]})})]})};ye.propTypes={fields:f.array.isRequired};const Ss=({})=>{const s=S(),{loading:r}=k(m=>m.fetchProductDataFields),{fields:i}=k(m=>m.productDataFieldsState),{id:a}=Ce(),[n,c]=N.useState(!1),p=De(),[x]=ne(),l=Te({mode:"all"});N.useEffect(()=>{Le(t("Manage product data fields")),Pe("#/"),s(Ve(a)).then(m=>{s($e(m.payload)),m.payload&&m.payload.map((o,j)=>{l.setValue(`fields.${j}`,o)})}).catch(m=>{console.error(m),c(!0)})},[]);const d=()=>{const m=U();s(P({field:{id:m,name:"field",type:H,isRequired:!1,description:null,defaultValue:null,options:[]}})),_(1).then(()=>{V(m)})},h=()=>!(l.formState.errors&&l.formState.errors.pages),g=m=>{s(Be(m)).then(o=>{const j=o.payload;j.success?(p(`/product-data/product/fields/${a}`),$.success(t("WooCommerce product data fields successfully saved"))):$.error(j.error)}).catch(o=>{$.error(o)})},u=[e.jsx(D,{style:y.SECONDARY,onClick:m=>{m.preventDefault(),d()},children:t("Add field")}),e.jsx(D,{disabled:!h(),style:y.PRIMARY,children:t("Save")}),e.jsx(Je,{})];return r?e.jsx(Ue,{}):n?e.jsx(Ye,{}):e.jsx(Se,{...l,children:e.jsx("form",{onSubmit:l.handleSubmit(g),children:e.jsxs(Ge,{title:t("Manage option pages"),actions:u,crumbs:[{label:t("Registered Custom Post Types"),link:"/"},{label:t("WooCommerce product data"),link:"/product-data/product"},{label:t("product data fields")}],children:[e.jsx(W,{register:l.register,id:"productDataId",value:a}),e.jsx("div",{ref:x,children:e.jsx(ye,{fields:_e(i)?[]:i})})]})})})};export{Ss as default};
