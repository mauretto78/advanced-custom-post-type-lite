import{j as s,e as le,u as t,s as ne}from"./fields-PF-HBT_1.js";import{a as f,R as P,u as O,d as oe}from"./vendor-Bd2ZL6QG.js";import{P as o,I as ue,B as C,s as T,b as E,i as Y,u as pe,w as ce,c as de,m as B,L as _e,aw as he,r as me}from"./index-DMK511Nl.js";import{S as F,a as ge}from"./StepsHeader-DqHupR6V.js";import{I as k}from"./Input-CuFxMsRB.js";import{g as fe,u as be,a as M,F as U}from"./index.esm-VK9FF9DZ.js";import{L as W,a as ve,s as ye,n as H}from"./Layout-B2PWyaeR.js";import{C as G,a as h}from"./CardRow-Dw7_IcZg.js";import{i as xe,b as we,v as z}from"./validation-CQ1_cb67.js";import{M as je}from"./index-CaoxaUGe.js";import{E as Se}from"./index-BSY6Y1mo.js";import{C as qe}from"./Checkbox-B7lS5GHu.js";import{p as Re}from"./postLabels-CJQPm0hi.js";import{T as q}from"./Toggle-BtOR4DWi.js";import"./Select-C_gKOLqa.js";import{I as ke}from"./InputHidden-S2GZha4D.js";import{P as Ce}from"./index-B64eJMy8.js";const J=({icon:b,isSelected:m,callback:y})=>s.jsx("div",{title:b,className:`icon ${m?"selected":""}`,onClick:()=>{y(b)},children:s.jsx(ue,{icon:b,width:"24px"})});J.propTypes={icon:o.string.isRequired,isSelected:o.bool,callback:o.func};const K=({type:b,defaultIcon:m=null,callback:y})=>{const[d,v]=f.useState([]),g="https://api.iconify.design/",r=l=>{fetch(`${g}search?query=${l}&prefix=dashicons&limit=96`).then(n=>n.json()).then(n=>{v(n.icons)})},p=()=>{fetch(`${g}collection?prefix=dashicons`).then(l=>l.json()).then(l=>{let n=[];l.uncategorized.map(e=>{n.push(`dashicons-${e}`)}),v(n)})},_=()=>{if(!wp||!wp.media){alert(t("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"));return}const l=wp.media({title:t("Upload an Image"),library:{type:["image"]},multiple:!1});l.on("select",function(n){const a=l.state().get("selection").first().toJSON().url;y(a)}),l.open()};return f.useEffect(()=>{p()},[]),b==="image"?s.jsxs(P.Fragment,{children:[m&&le(m)&&s.jsx("div",{className:"fit-content mt-8 mb-8 p-8 with-border b-rounded",children:s.jsx("img",{src:m,alt:"",width:128})}),s.jsx("a",{href:"#",className:"mt-1 acpt-btn acpt-btn-primary-o acpt-btn-block",onClick:l=>{l.preventDefault(),l.stopPropagation(),_()},children:t("Upload an Image")})]}):s.jsxs(P.Fragment,{children:[s.jsx("div",{className:"form-group",children:s.jsx("input",{type:"text",className:"form-control",placeholder:t("Type at least 3 characters to start searching."),onChange:async l=>{const n=l.currentTarget.value;n.length===0&&p(),n.length>=3&&r(n)}})}),d.length>0&&s.jsx("div",{className:"mt-24 icon-picker-wrapper","data-cy":"icon-picker-wrapper",children:d.map(l=>s.jsx(J,{isSelected:m===l,icon:l,callback:y}))})]})};K.propTypes={type:o.string.isRequired,defaultIcon:o.string,callback:o.func};const X=({callback:b,id:m,validate:y,register:d,description:v,defaultValue:g,errors:r})=>{const p=fe(r,m),[_,l]=f.useState(g),[n,e]=f.useState(!1),[a,x]=f.useState(null),u=w=>{l(w),b(w),e(!1)};f.useEffect(()=>{g!==null&&l(g)},[g]);const R=w=>{x(w),e(!n)};return s.jsxs(P.Fragment,{children:[n&&s.jsxs(je,{title:t("Choose icon"),visible:n,setVisible:e,testId:m,children:[s.jsxs("div",{className:"text-left",children:[s.jsx("label",{className:"form-label",htmlFor:"icon-picker",children:t("Select icon type from the list")}),s.jsxs("select",{"data-cy":"select-icon",onChange:w=>{w.preventDefault(),w.stopPropagation(),x(w.currentTarget.value)},defaultValue:a,className:"form-control",id:"icon-picker",children:[s.jsx("option",{value:"",children:t("--Select--")}),s.jsx("option",{value:"dashicon",children:t("Select a Dashicon")}),s.jsx("option",{value:"image",children:t("Upload an icon image")})]})]}),a&&s.jsx("div",{className:"mt-8",children:s.jsx(K,{type:a,defaultIcon:_,callback:u})})]}),s.jsxs("div",{className:"flex-center s-8",children:[_&&s.jsx(Se,{value:_}),s.jsx("input",{id:m,name:m,type:"text","data-cy":"input-icon",value:_||"",className:"hidden",...d(m,y)}),s.jsxs("div",{className:"i-flex-center s-8",children:[s.jsx(C,{onClick:w=>{w.preventDefault(),w.stopPropagation(),R("dashicon")},style:T.SECONDARY,size:"sm",testId:`${m}_dashicon`,children:t("Choose icon")}),s.jsx(C,{onClick:w=>{w.preventDefault(),w.stopPropagation(),R("image")},style:T.BORDERED,size:"sm",testId:`${m}_image`,children:t("Upload an icon image")})]})]}),v&&s.jsx("div",{className:"form-description",children:v}),p&&s.jsx("div",{"data-cy":"input-error-icon",className:"invalid-feedback",children:p.message})]})};X.propTypes={id:o.string.isRequired,defaultValue:o.string,description:o.string,callback:o.func,validate:o.func,register:o.func.isRequired,errors:o.array.isRequired};const $=({stepActive:b,setStepActive:m,setFormValues:y=null,steps:d})=>{const{getValues:v}=be();let g=[];for(const[r,p]of Object.entries(d))g.push(s.jsx("li",{className:`acpt-accordion-tab ${parseInt(r)===parseInt(b)?"active":""}`,onClick:()=>{y&&y(_=>(_[parseInt(b)+1]=v(),_)),m(r)},children:s.jsx("span",{children:p.label})},r));return s.jsx("div",{className:"acpt-tabs",children:s.jsx("ul",{role:"tablist",className:"tablist mb-12",children:g&&g.map(r=>r)})})};$.propTypes={setFormValues:o.func,setStepActive:o.func.isRequired,stepActive:o.number.isRequired,steps:o.arrayOf(o.shape({label:o.string.isRequired,description:o.string.isRequired})).isRequired};const Z=({title:b,crumbs:m,headings:y,stepActive:d,setStepActive:v,handleSubmit:g,edit:r=!1,formValues:p,setFormValues:_=null})=>{const{data:l}=E(j=>j.fetchCustomPostTypes),[n,e]=f.useState(null),[a,x]=f.useState({title:!0,editor:!0,thumbnail:!0,excerpt:!0,author:!1,trackbacks:!1,custom_fields:!1,comments:!1,revisions:!1,page_attributes:!1,post_formats:!1}),u=M({mode:"onChange"});f.useEffect(()=>{l.length>0&&(e(l[0].icon),x({title:l[0].supports.includes("title"),editor:l[0].supports.includes("editor"),thumbnail:l[0].supports.includes("thumbnail"),excerpt:l[0].supports.includes("excerpt"),author:l[0].supports.includes("author"),trackbacks:l[0].supports.includes("trackbacks"),custom_fields:l[0].supports.includes("custom-fields"),comments:l[0].supports.includes("comments"),revisions:l[0].supports.includes("revisions"),page_attributes:l[0].supports.includes("page-attributes"),post_formats:l[0].supports.includes("post-formats")}),u.setValue("post_name",l[0].name),u.setValue("singular_label",l[0].singular),u.setValue("plural_label",l[0].plural),u.setValue("icon",l[0].icon),u.setValue("support_0",l[0].supports.includes("title")?"title":!1),u.setValue("support_1",l[0].supports.includes("editor")?"editor":!1),u.setValue("support_2",l[0].supports.includes("thumbnail")?"thumbnail":!1),u.setValue("support_3",l[0].supports.includes("excerpt")?"excerpt":!1),u.setValue("support_4",l[0].supports.includes("author")?"author":!1),u.setValue("support_5",l[0].supports.includes("trackbacks")?"trackbacks":!1),u.setValue("support_6",l[0].supports.includes("custom-fields")?"custom-fields":!1),u.setValue("support_7",l[0].supports.includes("comments")?"comments":!1),u.setValue("support_8",l[0].supports.includes("revisions")?"revisions":!1),u.setValue("support_9",l[0].supports.includes("page-attributes")?"page-attributes":!1),u.setValue("support_10",l[0].supports.includes("post-formats")?"post-formats":!1))},[]),f.useEffect(()=>{p&&p[1]&&(e(p[1].icon),x({title:p[1].support_0,editor:p[1].support_1,thumbnail:p[1].support_2,excerpt:p[1].support_3,author:p[1].support_4,trackbacks:p[1].support_5,custom_fields:p[1].support_6,comments:p[1].support_7,revisions:p[1].support_8,page_attributes:p[1].support_9,post_formats:p[1].support_10}),u.setValue("post_name",p[1].post_name),u.setValue("singular_label",p[1].singular_label),u.setValue("plural_label",p[1].plural_label),u.setValue("icon",p[1].icon),u.setValue("support_0",p[1].support_0),u.setValue("support_1",p[1].support_1),u.setValue("support_2",p[1].support_2),u.setValue("support_3",p[1].support_3),u.setValue("support_4",p[1].support_4),u.setValue("support_5",p[1].support_5),u.setValue("support_6",p[1].support_6),u.setValue("support_7",p[1].support_7),u.setValue("support_8",p[1].support_8),u.setValue("support_9",p[1].support_9),u.setValue("support_10",p[1].support_10))},[p]);const R=j=>{u.setValue("post_name",ne(j,20))},w=j=>{p[1]&&_(V=>{const c={...V};return c[1].singular_label=j,c})},i=j=>{g(j,1),r||v(1)},I=[s.jsx(C,{testId:"next-step",style:r?T.PRIMARY:T.SECONDARY,children:t(r?"Save":"Next Step")})];return s.jsx(U,{...u,children:s.jsx("form",{onSubmit:u.handleSubmit(i),children:s.jsxs(W,{crumbs:m,title:b,actions:I,children:[r&&s.jsx($,{setFormValues:_,stepActive:d,setStepActive:v,steps:y}),s.jsxs(G,{style:"with-shadow",children:[!r&&s.jsx(F,{stepActive:d,headings:y}),s.jsx(h,{label:t("Post name"),value:s.jsx(k,{id:"post_name",placeholder:t("Post name"),readOnly:l.length>0,description:t("The post name/slug. Used for various queries."),onChangeCapture:j=>R(j.currentTarget.value),register:u.register,errors:u.formState.errors,isRequired:!0,validate:{validate:r?xe:we,required:t("This field is mandatory")}})}),s.jsx(h,{label:t("Singular label"),value:s.jsx(k,{id:"singular_label",placeholder:t("(e.g. Movie)"),defaultValue:l.length>0?l[0].singular:null,description:t("Used when a singular label is needed"),register:u.register,errors:u.formState.errors,isRequired:!0,onChangeCapture:j=>w(j.currentTarget.value),validate:{required:t("This field is mandatory")}})}),s.jsx(h,{label:t("Plural label"),value:s.jsx(k,{id:"plural_label",placeholder:t("(e.g. Movies)"),defaultValue:l.length>0?l[0].plural:null,description:t("Used for the post type admin menu item"),register:u.register,errors:u.formState.errors,isRequired:!0,validate:{required:t("This field is mandatory")}})}),s.jsx(h,{label:t("Icon"),value:s.jsx(X,{id:"icon",callback:j=>{u.setValue("icon",j)},defaultValue:n,register:u.register,errors:u.formState.errors,description:t("Displayed on the sidebar of the admin panel"),validate:{required:t("This field is mandatory")}})}),s.jsx(h,{label:t("Support"),wizard:`${t("Add support for various available post edit features. For more info")} <a target='_blank' href='https://developer.wordpress.org/reference/functions/register_post_type/#supports'>${t("see here")}<a/>.`,value:s.jsx(qe,{register:u.register,errors:u.formState.errors,id:"support",values:{title:{value:"title",checked:a.title},editor:{value:"editor",checked:a.editor},thumbnail:{value:"thumbnail",checked:a.thumbnail},excerpt:{value:"excerpt",checked:a.excerpt},author:{value:"author",checked:a.author},trackbacks:{value:"trackbacks",checked:a.trackbacks},"custom-fields":{value:"custom-fields",checked:a.custom_fields},comments:{value:"comments",checked:a.comments},revisions:{value:"revisions",checked:a.revisions},"page-attributes":{value:"page-attributes",checked:a.page_attributes},"post-formats":{value:"post-formats",checked:a.post_formats}}})})]})]})})})};Z.propTypes={headings:o.arrayOf(o.shape({label:o.string.isRequired,description:o.string.isRequired})).isRequired,title:o.string.isRequired,crumbs:o.arrayOf(C).isRequired,stepActive:o.number.isRequired,setStepActive:o.func.isRequired,handleSubmit:o.func.isRequired,formValues:o.object.isRequired,setFormValues:o.func,edit:o.bool};const ee=({title:b,crumbs:m,headings:y,stepActive:d,setStepActive:v,handleSubmit:g,formValues:r,setFormValues:p=null,edit:_})=>{const{data:l}=E(u=>u.fetchCustomPostTypes);let n={};l.length>0&&(n=l[0].labels);const e=M({mode:"onChange"});f.useEffect(()=>{_&&l.length>0&&(e.setValue("menu_name",n.menu_name),e.setValue("all_items",n.all_items),e.setValue("add_new",n.add_new),e.setValue("add_new_item",n.add_new_item),e.setValue("edit_item",n.edit_item),e.setValue("new_item",n.new_item),e.setValue("view_item",n.view_item),e.setValue("view_items",n.view_items),e.setValue("search_item",n.search_item),e.setValue("not_found",n.not_found),e.setValue("not_found_in_trash",n.not_found_in_trash),e.setValue("parent_item_colon",n.parent_item_colon),e.setValue("featured_image",n.featured_image),e.setValue("set_featured_image",n.set_featured_image),e.setValue("remove_featured_image",n.remove_featured_image),e.setValue("use_featured_image",n.use_featured_image),e.setValue("archives",n.archives),e.setValue("insert_into_item",n.insert_into_item),e.setValue("uploaded_to_this_item",n.uploaded_to_this_item),e.setValue("filter_items_list",n.filter_items_list),e.setValue("items_list_navigation",n.items_list_navigation),e.setValue("items_list",n.items_list),e.setValue("filter_by_date",n.filter_by_date),e.setValue("item_published",n.item_published),e.setValue("item_published_privately",n.item_published_privately),e.setValue("item_reverted_to_draft",n.item_reverted_to_draft),e.setValue("item_scheduled",n.item_scheduled),e.setValue("item_updated",n.item_updated))},[]),f.useEffect(()=>{_?r&&r[2]&&(e.setValue("menu_name",r[2].menu_name),e.setValue("all_items",r[2].all_items),e.setValue("add_new",r[2].add_new),e.setValue("add_new_item",r[2].add_new_item),e.setValue("edit_item",r[2].edit_item),e.setValue("new_item",r[2].new_item),e.setValue("view_item",r[2].view_item),e.setValue("view_items",r[2].view_items),e.setValue("search_item",r[2].search_item),e.setValue("not_found",r[2].not_found),e.setValue("not_found_in_trash",r[2].not_found_in_trash),e.setValue("parent_item_colon",r[2].parent_item_colon),e.setValue("featured_image",r[2].featured_image),e.setValue("set_featured_image",r[2].set_featured_image),e.setValue("remove_featured_image",r[2].remove_featured_image),e.setValue("use_featured_image",r[2].use_featured_image),e.setValue("archives",r[2].archives),e.setValue("insert_into_item",r[2].insert_into_item),e.setValue("uploaded_to_this_item",r[2].uploaded_to_this_item),e.setValue("filter_items_list",r[2].filter_items_list),e.setValue("items_list_navigation",r[2].items_list_navigation),e.setValue("items_list",r[2].items_list),e.setValue("filter_by_date",r[2].filter_by_date),e.setValue("item_published",r[2].item_published),e.setValue("item_published_privately",r[2].item_published_privately),e.setValue("item_reverted_to_draft",r[2].item_reverted_to_draft),e.setValue("item_scheduled",r[2].item_scheduled),e.setValue("item_updated",r[2].item_updated)):r&&r[1]&&(e.setValue("menu_name",r[1].plural_label),e.setValue("all_items",`${t("All {{r}}",{r:r[1].plural_label})}`),e.setValue("add_new",`${t("Add")} ${r[1].singular_label}`),e.setValue("add_new_item",`${t("Add new {{r}}",{r:r[1].singular_label})}`),e.setValue("edit_item",`${t("Edit")} ${r[1].singular_label}`),e.setValue("new_item",`${t("New")} ${r[1].singular_label}`),e.setValue("view_item",`${t("View")} ${r[1].singular_label}`),e.setValue("view_items",`${t("View")} ${r[1].plural_label}`),e.setValue("search_item",`${t("Search")} ${r[1].plural_label}`),e.setValue("not_found",t("No {{r}} found",{r:r[1].singular_label})),e.setValue("not_found_in_trash",t("No {{r}} found",{r:r[1].singular_label})),e.setValue("parent_item_colon",t("Parent item")),e.setValue("featured_image",t("Featured image")),e.setValue("set_featured_image",t("Set featured image")),e.setValue("remove_featured_image",t("Remove featured image")),e.setValue("use_featured_image",t("Use featured image")),e.setValue("archives",t("Archives")),e.setValue("insert_into_item",t("Insert")),e.setValue("uploaded_to_this_item",t("Upload")),e.setValue("filter_items_list",t("Filter {{r}} list",{r:r[1].plural_label})),e.setValue("items_list_navigation",t("Navigation list {{r}}",{r:r[1].plural_label})),e.setValue("items_list",t("List {{r}}",{r:r[1].plural_label})),e.setValue("filter_by_date",t("Filter by date")),e.setValue("item_published",t("{{r}} published",{r:r[1].singular_label})),e.setValue("item_published_privately",t("{{r}} published privately",{r:r[1].singular_label})),e.setValue("item_reverted_to_draft",t("{{r}} reverted to draft",{r:r[1].singular_label})),e.setValue("item_scheduled",t("{{r}} scheduled",{r:r[1].singular_label})),e.setValue("item_updated",t("{{r}} updated",{r:r[1].singular_label})))},[r]);const a=u=>{g(u,2),_||v(2)};let x=[];return _||x.push(s.jsx(C,{testId:"prev-step",type:"button",onClick:()=>v(0),style:T.SECONDARY,children:t("Previous Step")})),x.push(s.jsx(C,{testId:"next-step",style:_?T.PRIMARY:T.SECONDARY,children:t(_?"Save":"Next Step")})),s.jsx(U,{...e,children:s.jsx("form",{onSubmit:e.handleSubmit(a),children:s.jsxs(W,{crumbs:m,title:b,actions:x,children:[_&&s.jsx($,{setFormValues:p,stepActive:d,setStepActive:v,steps:y}),s.jsxs(G,{style:"with-shadow",children:[!_&&s.jsx(F,{stepActive:d,headings:y}),Re.map(u=>s.jsx(h,{label:u.label,value:s.jsx(k,{id:u.id,register:e.register,description:u.description,errors:e.formState.errors,isRequired:!0,validate:{required:t("This field is mandatory")}})}))]})]})})})};ee.propTypes={headings:o.arrayOf(o.shape({label:o.string.isRequired,description:o.string.isRequired})).isRequired,title:o.string.isRequired,crumbs:o.arrayOf(C).isRequired,stepActive:o.number.isRequired,setStepActive:o.func.isRequired,handleSubmit:o.func.isRequired,formValues:o.object.isRequired,setFormValues:o.func,edit:o.bool.isRequired};const te=({id:b,register:m,setValue:y,defaultValue:d,description:v})=>{const g=f.useRef(null),r=f.useRef(null),p=()=>{const n=g.current.value,e=r.current.value;if(n&&e){const a=n==="after"?parseInt(e)+1:parseInt(e)-1;y(b,a)}},_=()=>{const n=a=>{const x=a.replace(/(<([^>]+)>)/gi,"");return a.length!==x.length?a.split(" ")[0]:a};let e=[];for(const[a,x]of Object.entries(document.globals.menu))e.push({label:x[0]!==""?n(x[0]):"----",value:a});return e},l=()=>{if(!d)return{position:null,menu:null};for(const[a,x]of Object.entries(document.globals.menu)){if(parseInt(a)+1===d)return{position:"after",menu:a};if(parseInt(a)-1===d)return{position:"before",menu:a}}const e=Object.keys(document.globals.menu).findIndex(a=>parseInt(a)===parseInt(d));return Object.entries(document.globals.menu)[e+1]?{position:"before",menu:Object.entries(document.globals.menu)[e+1][0]}:Object.entries(document.globals.menu)[e-1]?{position:"after",menu:Object.entries(document.globals.menu)[e-1][0]}:{position:null,menu:null}};return s.jsxs(P.Fragment,{children:[s.jsx(ke,{register:m,id:b,value:d}),s.jsxs("div",{className:"i-flex-center s-8 w-100",children:[s.jsx("div",{className:"acpt-select w-50",children:s.jsxs("select",{ref:g,"data-cy":`position-${b}`,className:"form-control",onChangeCapture:p,defaultValue:l().position,children:[s.jsx("option",{value:"",children:t("Select")}),s.jsx("option",{value:"after",children:t("After")}),s.jsx("option",{value:"before",children:t("Before")})]})}),s.jsx("div",{className:"acpt-select w-50",children:s.jsxs("select",{ref:r,"data-cy":`menu-${b}`,className:"form-control",onChangeCapture:p,defaultValue:l().menu,children:[s.jsx("option",{value:"",children:t("Select")}),_().map(n=>s.jsx("option",{value:n.value,children:n.label},n.value))]})})]}),v&&s.jsx("div",{className:"form-description",children:v})]})};te.propTypes={id:o.string.isRequired,defaultValue:o.number,description:o.string,setValue:o.func.isRequired,register:o.func.isRequired};const se=({title:b,crumbs:m,headings:y,stepActive:d,setStepActive:v,handleSubmit:g,formValues:r,isWPGraphQLActive:p=!1,loading:_=!1,edit:l=!1,setFormValues:n=null})=>{const{data:e}=E(S=>S.fetchCustomPostTypes);let a={};e.length>0&&(a=e[0].settings);const[x,u]=f.useState("toggle"),{postType:R}=O(),w=()=>R||(r&&!Y(r)?r[1].post_name:null),i=M({mode:"all",defaultValues:{hierarchical:e.length>0?a.hierarchical:null,public:e.length>0?a.public:null,publicly_queryable:e.length>0?a.publicly_queryable:null,show_ui:e.length>0?a.show_ui:null,show_in_menu:e.length>0?a.show_in_menu:null,show_in_nav_menus:e.length>0?a.show_in_nav_menus:null,show_in_admin_bar:e.length>0?a.show_in_admin_bar:null,show_in_rest:e.length>0?a.show_in_rest:null,rest_base:e.length>0?a.rest_base:null,menu_position:e.length>0?a.menu_position:null,capability_type:e.length>0?a.capability_type:"post",has_archive:e.length>0?a.has_archive:null,rewrite:e.length>0?a.rewrite:null,with_front:e.length>0?a.with_front:null,custom_rewrite:e.length>0?a.custom_rewrite:null,query_var:e.length>0?a.query_var:null,custom_query_var:e.length>0?a.custom_query_var:null,front_url_prefix:e.length>0&&typeof a.front_url_prefix<"u"?a.front_url_prefix:w()}});f.useEffect(()=>{e.length>0&&typeof a.show_in_menu=="string"&&u("custom"),r&&!Y(r)&&(i.setValue("show_in_graphql",e.length>0?a.show_in_graphql:!0),i.setValue("graphql_single_name",e.length>0&&a.graphql_single_name?a.graphql_single_name.toLowerCase():r[1].singular_label.toLowerCase()),i.setValue("graphql_plural_name",e.length>0&&a.graphql_plural_name?a.graphql_plural_name.toLowerCase():r[1].plural_label.toLowerCase())),l&&r&&r[3]&&(i.setValue("hierarchical",r[3].hierarchical),i.setValue("public",r[3].public),i.setValue("publicly_queryable",r[3].publicly_queryable),i.setValue("show_ui",r[3].show_ui),i.setValue("show_in_menu",r[3].show_in_menu),i.setValue("show_in_nav_menus",r[3].show_in_nav_menus),i.setValue("show_in_admin_bar",r[3].show_in_admin_bar),i.setValue("show_in_rest",r[3].show_in_rest),i.setValue("rest_base",r[3].rest_base),i.setValue("menu_position",r[3].menu_position),i.setValue("capability_type",r[3].capability_type),i.setValue("has_archive",r[3].has_archive),i.setValue("rewrite",r[3].rewrite),i.setValue("custom_rewrite",r[3].custom_rewrite),i.setValue("query_var",r[3].query_var),i.setValue("custom_query_var",r[3].custom_query_var),i.setValue("with_front",typeof r[3].with_front<"u"?r[3].with_front:!0),i.setValue("front_url_prefix",r[3].front_url_prefix))},[r]);const I=()=>l&&r&&r[3]?r[3].menu_position:e.length>0?a.menu_position:null,j=i.watch("show_in_graphql"),V=i.watch("graphql_single_name"),c=i.watch("graphql_plural_name"),A=S=>{i.setValue("graphql_single_name",S.toLowerCase())},Q=S=>{i.setValue("graphql_plural_name",S.toLowerCase())},N=S=>{if(S===c)return t("Single name MUST be different from plural name")},L=S=>{if(S===V)return t("Different name MUST be different from single name")},re=i.watch("rewrite"),ae=i.watch("query_var"),ie=S=>{g(S,3)};let D=[];return l||D.push(s.jsx(C,{testId:"prev-step",type:"button",onClick:()=>v(1),style:T.SECONDARY,children:t("Previous Step")})),D.push(s.jsx(C,{testId:"next-step",style:T.PRIMARY,children:t("Save")})),s.jsx(U,{...i,children:s.jsx("form",{onSubmit:i.handleSubmit(ie),children:s.jsxs(W,{crumbs:m,title:b,actions:D,children:[l&&s.jsx($,{setFormValues:n,stepActive:d,setStepActive:v,steps:y}),s.jsxs(G,{style:"with-shadow",children:[!l&&s.jsx(F,{setStepActive:v,stepActive:d,headings:y}),p&&s.jsxs(P.Fragment,{children:[s.jsx(h,{label:t("Show in GraphQL"),value:s.jsx(q,{id:"show_in_graphql",description:t("Show the custom post type in WPGraphQL."),defaultValue:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("GraphQL single name"),value:s.jsx(k,{id:"graphql_single_name",register:i.register,placeholder:t("Ex. movie"),description:t("Camel case string with no punctuation or spaces. Needs to start with a letter (not a number). Important to be different than the plural name."),errors:i.formState.errors,isRequired:j,onChangeCapture:S=>A(S.currentTarget.value),validate:{validate:{validWPGraphQLName:z,handleGraphQLSingleNameChange:N}}})}),s.jsx(h,{label:t("GraphQL plural name"),value:s.jsx(k,{id:"graphql_plural_name",register:i.register,placeholder:t("Ex. movies"),description:t("Camel case string with no punctuation or spaces. Needs to start with a letter (not a number). Important to be different than the single name."),errors:i.formState.errors,isRequired:j,onChangeCapture:S=>Q(S.currentTarget.value),validate:{validate:{validWPGraphQLName:z,handleGraphQLPluralNameChange:L}}})})]}),s.jsx(h,{label:t("Hierarchical"),value:s.jsx(q,{id:"hierarchical",description:t("Whether the post type is hierarchical (e.g. page). Default false."),defaultValue:e.length>0?a.hierarchical:!1,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Is Public"),value:s.jsx(q,{id:"public",description:t("Whether a post type is intended for use publicly either via the admin interface or by front-end users."),defaultValue:e.length>0?a.public:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Publicly queryable"),value:s.jsx(q,{id:"publicly_queryable",description:t("Whether queries can be performed on the front end for the post type as part of parse_request()."),defaultValue:e.length>0?a.publicly_queryable:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Show in UI"),value:s.jsx(q,{id:"show_ui",description:t("Whether to generate and allow a UI for managing this post type in the admin. Default is value of $public."),defaultValue:e.length>0?a.show_ui:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Show in menu"),value:s.jsxs(P.Fragment,{children:[x==="toggle"&&s.jsx(q,{id:"show_in_menu",description:t("Where to show the post type in the admin menu. To work, $show_ui must be true. If true, the post type is shown in its own top level menu. If false, no menu is shown."),defaultValue:e.length>0?a.show_in_menu:!0,register:i.register,errors:i.formState.errors}),x==="custom"&&s.jsx(k,{id:"show_in_menu",defaultValue:e.length>0?a.show_in_menu:"",placeholder:t("Custom show in menu rule"),description:`${t("Where to show the post type in the admin menu. Set a custom show in menu rule here. For more info")} <a target='_blank' href='https://developer.wordpress.org/reference/functions/register_post_type/#show_in_menu'>${t("see here")}<a/>.`,validate:{maxLength:{value:255,message:t("max length is 255")}},register:i.register,errors:i.formState.errors}),s.jsx("a",{className:"mt-12",href:"#",onClick:S=>{S.preventDefault(),u(x==="toggle"?"custom":"toggle")},children:t(x==="custom"?"Standard settings":"Set custom settings")})]})}),s.jsx(h,{label:t("Show in nav menus"),value:s.jsx(q,{id:"show_in_nav_menus",description:t("Makes this post type available for selection in navigation menus. Default is value of $public."),defaultValue:e.length>0?a.show_in_nav_menus:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Show in admin bar"),value:s.jsx(q,{id:"show_in_admin_bar",description:t("Makes this post type available via the admin bar. Default is value of $show_in_menu."),defaultValue:e.length>0?a.show_in_admin_bar:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Show in REST API"),value:s.jsx(q,{id:"show_in_rest",description:t("Whether to include the post type in the REST API. Set this to true for the post type to be available in the block editor. SET TRUE TO ENABLE GUTEMBERG EDITOR."),defaultValue:e.length>0?a.show_in_rest:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("REST API base slug"),value:s.jsx(k,{id:"rest_base",placeholder:t("REST API base slug"),description:t("To change the base url of REST API route. Default is $post_type."),validate:{maxLength:{value:255,message:t("max length is 255")}},register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Menu position"),value:s.jsx(te,{id:"menu_position",defaultValue:I(),description:t("The position in the menu order the post type should appear. To work, $show_in_menu must be true. Default null (at the bottom)."),register:i.register,setValue:i.setValue})}),s.jsx(h,{label:t("Capability type"),value:s.jsx(k,{id:"capability_type",defaultValue:"post",description:t("The string to use to build the read, edit, and delete capabilities. May be passed as an array to allow for alternative plurals when using this argument as a base to construct the capabilities, e.g. array('story', 'stories'). Default 'post'."),validate:{maxLength:{value:255,message:"max length is 255"}},register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Has archive"),value:s.jsx(q,{id:"has_archive",description:t("Whether there should be post type archives, or if a string, the archive slug to use. Will generate the proper rewrite rules if $rewrite is enabled."),defaultValue:e.length>0?a.has_archive:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Rewrite"),value:s.jsx(q,{id:"rewrite",description:t("Triggers the handling of rewrites for this post type. To prevent rewrite, set to false. Defaults to true, using $post_type as slug. To specify rewrite rules, an array can be passed with any of these keys:"),defaultValue:e.length>0?a.rewrite:!0,register:i.register,errors:i.formState.errors})}),re&&s.jsx(h,{label:t("Custom rewrite rules"),value:s.jsx(k,{id:"custom_rewrite",placeholder:t("Custom rewrite rules"),description:t("Custom post type slug to use instead of default."),validate:{maxLength:{value:255,message:t("max length is 255")}},register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("With front"),value:s.jsx(q,{id:"with_front",description:t("Should the permalink structure be prepended with the front base. (example: if your permalink structure is /blog/, then your links will be: false->/news/, true->/blog/news/). Defaults to true"),defaultValue:e.length>0&&typeof a.with_front<"u"?a.with_front:!0,register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Query var"),value:s.jsx(q,{id:"query_var",description:t("Sets the query_var key for this post type. Defaults to  key. If false, a post type cannot be loaded at ?{query_var}={post_slug}. If specified as a string, the query {post_slug} will be valid."),defaultValue:e.length>0?a.query_var:!0,register:i.register,errors:i.formState.errors})}),ae&&s.jsx(h,{label:t("Custom query var"),value:s.jsx(k,{id:"custom_query_var",placeholder:t("Custom query var"),description:t("Custom query var slug to use instead of default."),validate:{maxLength:{value:255,message:t("min length is")+" 255"}},register:i.register,errors:i.formState.errors})}),s.jsx(h,{label:t("Front URL prefix"),value:s.jsx(k,{id:"front_url_prefix",placeholder:t("Front URL prefix"),description:t("Alters the post type permalink structure to add a prefix to singular posts URLs (ex. /movie/titanic). Default value is the post type name."),defaultValue:e.length>0&&a.front_url_prefix?typeof a.front_url_prefix<"u":w(),validate:{maxLength:{value:255,message:t("min length is")+" 255"}},register:i.register,errors:i.formState.errors})})]})]})})})};se.propTypes={headings:o.arrayOf(o.shape({label:o.string.isRequired,description:o.string.isRequired})).isRequired,title:o.string.isRequired,crumbs:o.arrayOf(C).isRequired,stepActive:o.number.isRequired,setStepActive:o.func.isRequired,handleSubmit:o.func.isRequired,formValues:o.object.isRequired,isWPGraphQLActive:o.bool,loading:o.bool,edit:o.bool,setFormValues:o.func};const Be=({})=>{const b=pe(),{loading:m}=E(c=>c.saveCustomPostType),{loading:y}=E(c=>c.fetchCustomPostTypes),{postType:d}=O(),{step:v}=O(),[g,r]=f.useState(!1),[p,_]=f.useState(!1),[l,n]=f.useState(v?parseInt(v):0),[e,a]=f.useState({}),[x,u]=f.useState(!1),[R,w]=f.useState(d&&e[1]?t("Edit")+" "+e[1].singular_label:t("Create new Custom Post Type")),i=oe();(d==="page"||d==="post")&&i("/"),f.useEffect(()=>{d&&e[1]&&w(t("Edit")+" "+e[1].singular_label)},[e]),f.useEffect(()=>{ce("isWPGraphQLActiveAction",{}).then(c=>{u(c.status)}).catch(c=>{console.error(c.message)})},[]),f.useEffect(()=>{d?(r(!0),b(de({postType:d})).then(c=>{c.payload.length!==1?_(!0):(a({1:{icon:c.payload[0].icon,plural_label:c.payload[0].plural,post_name:c.payload[0].name,singular_label:c.payload[0].singular,support_0:c.payload[0].supports.includes("title")?"title":!1,support_1:c.payload[0].supports.includes("editor")?"editor":!1,support_2:c.payload[0].supports.includes("thumbnail")?"thumbnail":!1,support_3:c.payload[0].supports.includes("excerpt")?"excerpt":!1,support_4:c.payload[0].supports.includes("author")?"author":!1,support_5:c.payload[0].supports.includes("trackbacks")?"trackbacks":!1,support_6:c.payload[0].supports.includes("custom-fields")?"custom-fields":!1,support_7:c.payload[0].supports.includes("comments")?"comments":!1,support_8:c.payload[0].supports.includes("revisions")?"revisions":!1,support_9:c.payload[0].supports.includes("page-attributes")?"page-attributes":!1,support_10:c.payload[0].supports.includes("post-formats")?"post-formats":!1},2:c.payload[0].labels,3:c.payload[0].settings}),B(`${t("Edit")} ${c.payload[0].singular}`))}).catch(c=>{_(!0),console.error(c)})):B(t("Register new Post Type"))},[]);const I=[{label:t("Registered Custom Post Types"),link:"/"},{label:R}],j=[{label:t("Basic"),description:t("Minimum configuration")},{label:t("Labels"),description:t("Additional labels")},{label:t("Settings"),description:t("Other settings")}],V=(c,A)=>{e[A]=c,a(e),ve(),Object.keys(e).length===3&&b(he(e)).then(N=>{const L=N.payload;L.success?(ye("Custom post type successfully saved."),i("/"),me()):H.error(L.error)}).catch(N=>{H.error(N)})};return g&&y?s.jsx(_e,{}):p?s.jsx(Ce,{}):s.jsx(P.Fragment,{children:s.jsx(ge,{steps:[s.jsx(Z,{edit:g,title:R,headings:j,crumbs:I,stepActive:l,setStepActive:n,handleSubmit:V,formValues:e,setFormValues:a}),s.jsx(ee,{edit:g,title:R,headings:j,crumbs:I,stepActive:l,setStepActive:n,handleSubmit:V,formValues:e,setFormValues:a}),s.jsx(se,{edit:g,title:R,headings:j,crumbs:I,stepActive:l,setStepActive:n,handleSubmit:V,formValues:e,setFormValues:a,isWPGraphQLActive:x,loading:m})],activeStep:l})})};export{Be as default};
