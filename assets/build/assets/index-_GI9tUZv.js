import{j as e,u as a,a as y}from"./fields-lEbqKXfy.js";import{a as b,d as W,R,L as X,u as H}from"./vendor-Bd2ZL6QG.js";import{s as N,n as E,B as T,a as I,f as z,L as Z}from"./Layout-CjJK5OT4.js";import{P as g,u as v,g as S,B as D,s as n,h as J,r as O,w as M,A as K,j as Q,b as ee,m as se,k as te,l as re,L as ae,n as P,o as ne}from"./index-BQ3U1-jG.js";import{B as C}from"./index--9-3Sden.js";import{M as w}from"./index-DYtzcsOi.js";import{u as F,a as le,b as ce,F as ie}from"./index.esm-VK9FF9DZ.js";import{m as i}from"./metaTypes-Bb9tjSPe.js";import{B as oe,P as de}from"./index-sBWX2MB_.js";import{u as ue}from"./index-BixwEkkR.js";const G=({page:r,id:m})=>{const o=document.globals.settings,{reset:u}=F(),x=v();o.length>0&&S(o,"key","records_per_page")!==""&&S(o,"key","records_per_page").value;const[l,h]=b.useState(!1),t=W(),s=()=>{x(J(m)).then(p=>{const k=p.payload;k.success?(u(),t("/meta"),h(!l),N("Meta group successfully deleted."),O()):E.error(k.error)}).catch(p=>console.error(p))},d=[e.jsx(D,{style:n.DANGER,onClick:()=>{s()},children:a("Yes, delete it")}),e.jsx(D,{style:n.SECONDARY,onClick:()=>{h(!l)},children:a("Return back to list")})];return e.jsxs(R.Fragment,{children:[e.jsx(w,{title:a("Delete meta group"),buttons:d,visible:l,children:e.jsx("div",{children:a("You are going to delete this meta group. Are you sure?")})}),e.jsx("a",{className:`color-${n.DANGER}`,href:"#",onClick:p=>{p.preventDefault(),h(!l)},children:a("Delete")})]})};G.propTypes={page:g.number.isRequired,id:g.string.isRequired};const L=({belongsTo:r,find:m})=>{const[j,o]=b.useState(m);let u=n.SECONDARY;return(r===i.TAXONOMY||r==="TERM_ID")&&(u=n.WARNING),r===i.OPTION_PAGE&&(u=n.INFO),r===i.COMMENT&&(u=n.BORDERED),r==="USER_ID"&&(u=n.DANGER),(r==="PARENT_POST_ID"||r==="POST_ID"||r==="POST_TAX"||r==="POST_CAT"||r==="POST_TEMPLATE"||r==="TERM_ID"||r==="USER_ID")&&(()=>{M("fetchFindAction",{belongsTo:r,id:m}).then(l=>{o(l)}).catch(l=>{console.error(l.message)})})(),r===i.USER?e.jsx(T,{style:n.DANGER,children:a("User")}):e.jsx(T,{style:u,children:j})};L.propTypes={belongsTo:g.string.isRequired,find:g.string.isRequired};const B=({belongs:r})=>{const j=document.globals.globals,[o,u]=b.useState(!1),x=t=>{if(!t.belongsTo)return"";let s="";switch(t.belongsTo){case i.CUSTOM_POST_TYPE:s="Custom post type";break;case i.TAXONOMY:s="Taxonomy";break;case i.OPTION_PAGE:s="Option page";break;case i.USER:s="All users";break;case i.COMMENT:s="All comments";break;case i.MEDIA:s="Attachment";break;case"PARENT_POST_ID":s="Post parent";break;case"POST_ID":s="Post";break;case"POST_TEMPLATE":s="Post template";break;case"POST_TAX":s="Post taxonomy";break;case"POST_CAT":s="Post category";break;case"TERM_ID":s="Term";break;case"USER_ID":s="User";break}return a(s)},l=t=>{if(!t.operator)return"";let s="";switch(t.operator){case"=":s="is equal to";break;case"!=":s="is not equal to";break;case"IN":s="is included in";break;case"NOT_IN":s="is not included in";break}return a(s)},h=t=>{if(!t.find||t.find==="")return"";const s=t.find.split(",");return s.length>0?e.jsx("div",{className:"i-flex-center flex-wrap s-4",children:s.map(d=>e.jsx(L,{belongsTo:t.belongsTo,find:d}))}):""};return e.jsxs(R.Fragment,{children:[e.jsx(w,{title:a("Location"),visible:o,textAlign:"left",children:r.length>0?e.jsx("div",{className:"responsive",children:e.jsx("table",{className:`acpt-table spaceless ${j.is_rtl?"rtl":""}`,children:e.jsx("tbody",{children:r.map((t,s)=>{const d=s===r.length-1;return e.jsxs("tr",{children:[e.jsx("td",{children:x(t)}),e.jsx("td",{children:l(t)}),e.jsx("td",{children:h(t)}),e.jsx("td",{children:!d&&t.logic&&a(t.logic)})]})})})})}):e.jsx(K,{style:n.SECONDARY,children:a("No conditions are present.")})}),e.jsx("a",{href:"#",onClick:t=>{t.preventDefault(),u(!o)},children:a("Show")})]})};B.propTypes={belongs:g.array.isRequired};const U=b.memo(({record:r,page:m})=>{const{register:j}=F(),o=`elements.${r.id}`,u=()=>{M("duplicateAction",{belongsTo:i.META,find:r.id}).then(t=>{t.success===!0?(N("Meta group successfully duplicated."),I(),O()):E.error(t.error)}).catch(t=>{console.error(t),E.error(a("Unknown error, please retry later"))})},x=t=>{let s,d;switch(t){default:case y.STANDARD:s=n.INFO,d=a("Standard view");break;case y.ACCORDION:s=n.SUCCESS,d=a("Accordion");break;case y.HORIZONTAL_TABS:s=n.WARNING,d=a("Horizontal tabs");break;case y.VERTICAL_TABS:s=n.DANGER,d=a("Vertical tabs");break}return!s||!d?null:e.jsx(T,{style:s,children:d})},l=t=>{let s;switch(t){case"advanced":s=n.SUCCESS;break;case"normal":s=n.INFO;break;case"side":s=n.DANGER;break}return s?e.jsx(T,{style:s,children:t}):null},h=t=>{let s;switch(t){case"default":s=n.SUCCESS;break;case"core":s=n.INFO;break;case"high":s=n.WARNING;break;case"low":s=n.DANGER;break}return s?e.jsx(T,{style:s,children:t}):null};return e.jsx(R.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:o,children:[e.jsx("input",{type:"checkbox",id:o,name:o,defaultChecked:!1,...j(o)}),e.jsx("span",{})]})}),e.jsx("td",{children:r.name}),e.jsx("td",{children:r.label}),e.jsx("td",{children:x(r.display)}),e.jsx("td",{children:l(r.context)}),e.jsx("td",{children:h(r.priority)}),e.jsx("td",{children:e.jsx(B,{belongs:r.belongs})}),e.jsx("td",{children:r.fieldsCount}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(X,{to:`/edit_meta/${r.id}`,children:a("Edit")}),e.jsx("a",{href:"#",onClick:t=>{t.preventDefault(),u()},children:a("Duplicate")}),e.jsx(G,{id:r.id,page:m})]})})]})})});U.propTypes={page:g.number.isRequired,record:g.object.isRequired};const he=()=>{const r=document.globals,m=r.settings,j=r.globals;Q(i.CUSTOM_POST_TYPE);const[o,u]=b.useReducer(c=>c+1,0);ue();const x=b.useRef(),l=le({mode:"all"}),h=ce({control:l.control,name:"elements"}),t=v(),{data:s,loading:d}=ee(c=>c.fetchMeta),{page:p}=H(),k=m.length>0&&S(m,"key","records_per_page")!==""?S(m,"key","records_per_page").value:20,_=Math.ceil(s.count/k);b.useEffect(()=>{se(a("Field groups")),te("#/meta"),t(re({page:p||1,perPage:k})).then(c=>{z()})},[p]),b.useEffect(()=>{(()=>{if(!h)return!1;let f=0;for(const[A,$]of Object.entries(h))$===!0&&f++;return f===Object.entries(h).length})()?x.current.checked=!0:x.current&&(x.current.checked=!1)},[h]),document.addEventListener("restoredElement",function(){u()});const Y=c=>{l.reset(),c.belongsTo=i.META;const f=c.action;if(f)switch(f){case"hide":ne(c);break;case"delete":case"duplicate":M("bulkActionsAction",c).then(A=>{if(A.success===!0){switch(c.action){case"delete":N("Meta group successfully deleted.");break;case"duplicate":N("Meta group successfully duplicated.");break}l.resetField("elements"),I(),O()}else E.error(A.error)}).catch(A=>{console.error(A),E.error(a("Unknown error, please retry later"))});break}},q=c=>{s.records.filter(f=>!P(f.id,i.META)).map(f=>{l.setValue(`elements.${f.id}`,c)})},V=[e.jsx(C,{style:n.PRIMARY,to:"/register_meta",children:a("Create new Meta group")})];return d?e.jsx(ae,{}):e.jsx(ie,{...l,children:e.jsx("form",{onSubmit:l.handleSubmit(Y),children:e.jsxs(Z,{title:a("Field groups"),actions:V,crumbs:[{label:a("Field groups")}],children:[e.jsx(oe,{belongsTo:i.META}),s.records&&s.records.length>0?e.jsx("div",{className:"responsive with-shadow b-rounded",children:e.jsxs("table",{className:`acpt-table ${j.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"all",children:[e.jsx("input",{ref:x,type:"checkbox",id:"all",defaultChecked:!1,onClick:c=>q(c.currentTarget.checked)}),e.jsx("span",{})]})}),e.jsx("th",{children:a("Group name")}),e.jsx("th",{children:a("Group label")}),e.jsx("th",{children:a("Display as")}),e.jsx("th",{children:a("Context")}),e.jsx("th",{children:a("Priority")}),e.jsx("th",{children:a("Location")}),e.jsx("th",{children:a("Fields count")}),e.jsx("th",{children:a("Actions")})]})}),e.jsx("tbody",{children:s.records&&s.records.map(c=>{if(!P(c.id,i.META))return e.jsx(U,{page:p,record:c},c.id)})}),_>1&&e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:9,children:e.jsx(de,{currentPage:p?parseInt(p):1,totalPages:_,baseLink:"/meta"})})})})]})}):e.jsx("div",{className:"p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:a("No meta group found.")}),e.jsx("div",{children:e.jsx(C,{type:"button",style:n.SECONDARY,to:"/register_meta",children:a("Create new Meta group")})})]})})]})})})};he.propTypes={};export{he as default};
