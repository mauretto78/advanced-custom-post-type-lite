import{u as e,j as t}from"./fields-B4O9Q4Yk.js";import{a as g}from"./vendor-BwziPlmK.js";import{n as r,L as B}from"./Layout-Cn7fGwLD.js";import{a as O,u as Y,m as k,c as M,r as N,B as A,s as P,f as m,e as U,g as z,w as G}from"./index-DIgvZvNa.js";import{C as b,a as s}from"./CardRow-CjwXcCAq.js";import{b as Q}from"./index.esm-Czmjla35.js";import{I as H}from"./Input-ChkMYR6a.js";import{S as D}from"./Select-VZ2U2AxS.js";import{T as u}from"./Toggle-BxQlEymb.js";const J=[{label:"Default",value:"Default"},{label:"Inter",value:"Inter"},{label:"Lato",value:"Lato"},{label:"Open Sans",value:"Open Sans"},{label:"Poppins",value:"Poppins"},{label:"Roboto",value:"Roboto"},{label:"Ubuntu",value:"Ubuntu"}],le=()=>{const{error:v,success:L,loading:d}=O(a=>a.saveSettings),R=Y(),[c,_]=g.useState(!1);g.useEffect(()=>{k(e("Settings page")),M("#/settings")},[]);const x=document.globals,o=x.settings,l=(a,f)=>{if(o.length===0||typeof m(o,"key",a)>"u"||U(m(o,"key",a)))return f;const p=m(o,"key",a).value;return p==="1"?1:p==="0"?0:p},S=l("delete_metadata",0),j=l("delete_posts",0),y=l("delete_tables_when_deactivate",0),h=l("enable_cache",0),T=l("font","Inter"),w=l("language","en_US"),C=l("records_per_page",20),{register:n,handleSubmit:E,formState:{errors:i,isValid:V}}=Q({mode:"all",defaultValues:{enable_cache:h,delete_metadata:S,delete_posts:j,delete_tables_when_deactivate:y,records_per_page:C,language:w,font:T}}),F=a=>{R(z({records_per_page:a.records_per_page,enable_cache:a.enable_cache?1:0,delete_tables_when_deactivate:a.delete_tables_when_deactivate?1:0,delete_posts:a.delete_posts?1:0,delete_metadata:a.delete_metadata?1:0,language:a.language?a.language:null,font:a.font?a.font:null})),_(!0)};g.useEffect(()=>{c&&L&&(r.success(e("Settings saved. The browser will refresh after 5 seconds.")),N(5e3)),c&&v!==null&&r.error(v),c&&_(!1)},[d]);const q=()=>{G("flushCacheAction",{}).then(a=>{a.success===!0?r.success(e("Cache was successfully flushed")):r.error(a.error)}).catch(a=>console.error(a))},I=[t.jsx(A,{testId:"save-settings",style:P.PRIMARY,disabled:!!(!V||d),children:d?e("Loading..."):e("Save")})];return t.jsx("form",{onSubmit:E(F),children:t.jsx(B,{crumbs:[{label:e("Settings")}],title:e("Settings"),actions:I,children:t.jsxs("div",{className:"flex-column s-24",children:[t.jsxs(b,{title:e("General settings"),children:[t.jsx(s,{label:e("Language"),value:t.jsx(D,{id:"language",label:e("Language"),placeholder:e("Set the language of the plug-in"),description:e("Set the language of the plug-in"),register:n,defaultValue:w,values:x.globals.available_languages,isRequired:!0,errors:i,validate:{required:"This field is mandatory"}})}),t.jsx(s,{label:e("Font"),value:t.jsx(D,{id:"font",label:e("Font"),placeholder:e("Set the font of the plug-in"),description:e("Set the font of the plug-in"),register:n,defaultValue:T,values:J,isRequired:!0,errors:i,validate:{required:"This field is mandatory"}})}),t.jsx(s,{label:e("Records per page"),value:t.jsx(H,{type:"number",id:"records_per_page",description:e("Set the number of records per page in your ACPT dashboards."),register:n,errors:i,isRequired:!0,defaultValue:C,min:1,max:200,validate:{required:"This field is mandatory"}})})]}),t.jsxs(b,{title:e("Performances"),children:[t.jsx(s,{label:e("Enable ACPT cache"),value:t.jsx(u,{id:"enable_cache",description:e("Enable the ACPT cache. The cache stores the MySQL results in simple textual files to avoid useless DB calls."),register:n,errors:i,defaultValue:h})}),h?t.jsx(s,{label:e("Flush the ACPT cache"),value:t.jsx(A,{style:P.SECONDARY,onClick:a=>{a.preventDefault(),q()},children:e("Flush cache")})}):null]}),t.jsxs(b,{title:e("Danger zone"),children:[t.jsx(s,{label:e("Delete ACPT definitions when deactivate the plug-in"),value:t.jsx(u,{id:"delete_tables_when_deactivate",description:e("Delete all saved ACPT definitions when you deactivate the plug-in. This means that if you select NO when you deactivate and then reactivate the plug-in you will find all the previously saved ACPT definitions (meta fields, options etc.)"),register:n,errors:i,defaultValue:y})}),t.jsx(s,{label:e("Delete posts when delete an ACPT post definition"),value:t.jsx(u,{id:"delete_posts",description:e("   Delete posts when delete an ACPT post type definition. This means that if you select YES, when you delete an ACPT post type definition all the saved posts will be deleted"),register:n,errors:i,defaultValue:j})}),t.jsx(s,{label:e("Delete metadata when delete an ACPT field"),value:t.jsx(u,{id:"delete_metadata",description:e("Delete post metadata when deleting an ACPT field. This means that if you select YES, when you delete an ACPT meta field all the saved metadata will be deleted"),register:n,errors:i,defaultValue:S})})]})]})})})};export{le as default};
