import{j as e,u as s,a as T}from"./fields-B4O9Q4Yk.js";import{a as g,u as U,R as N,L as M,d as V}from"./vendor-BwziPlmK.js";import{n as k,B as _,L as $,s as X}from"./Layout-3l8w9I7o.js";import{P as b,u as D,f as E,B as O,s as h,n as H,l as R,w as P,A as v,a as W,m as z,c as Z,L as J}from"./index-nWGa0jEF.js";import{B as K}from"./index-lTXmqbF6.js";import{M as C}from"./index-VDdQ26Pk.js";import{u as S,a as I,b as Q,F as ee}from"./index.esm-Czmjla35.js";import{m as p}from"./metaTypes-FCOIhGU8.js";import{P as se}from"./index-DfCGOGJX.js";import{u as te}from"./index-tMNRH81H.js";const w=({page:t,id:d})=>{const c=document.globals.settings,{reset:n}=S(),i=D(),l=c.length>0&&E(c,"key","records_per_page")!==""?E(c,"key","records_per_page").value:20,[f,r]=g.useState(!1),a=U(),o=()=>{i(H(d)).then(j=>{const y=j.payload;y.success?(n(),a("/meta"),r(!f),k.success(s("Meta group successfully deleted.")),i(R({page:t||1,perPage:l}))):k.error(y.error)}).catch(j=>console.error(j))},A=[e.jsx(O,{style:h.DANGER,onClick:()=>{o()},children:s("Yes, delete it")}),e.jsx(O,{style:h.SECONDARY,onClick:()=>{r(!f)},children:s("Return back to list")})];return e.jsxs(N.Fragment,{children:[e.jsx(C,{title:s("Delete meta group"),buttons:A,visible:f,children:e.jsx("div",{children:s("You are going to delete this meta group. Are you sure?")})}),e.jsx("a",{href:"#",onClick:j=>{j.preventDefault(),r(!f)},children:s("Delete")})]})};w.propTypes={page:b.number.isRequired,id:b.string.isRequired};const F=({belongsTo:t,find:d})=>{const[x,c]=g.useState(d);let n=h.SECONDARY;return(t===p.TAXONOMY||t==="TERM_ID")&&(n=h.WARNING),t===p.OPTION_PAGE&&(n=h.INFO),t===p.COMMENT&&(n=h.BORDERED),t==="USER_ID"&&(n=h.DANGER),(t==="POST_ID"||t==="POST_TAX"||t==="POST_CAT"||t==="POST_TEMPLATE"||t==="TERM_ID"||t==="USER_ID")&&(()=>{P("fetchFindAction",{belongsTo:t,id:d}).then(l=>{c(l)}).catch(l=>{console.error(l.message)})})(),t===p.USER?e.jsx(_,{style:h.DANGER,children:s("User")}):e.jsx(_,{style:n,children:x})};F.propTypes={belongsTo:b.string.isRequired,find:b.string.isRequired};const L=({belongs:t})=>{const x=document.globals.globals,[c,n]=g.useState(!1),i=r=>{if(!r.belongsTo)return"";let a="";switch(r.belongsTo){case p.CUSTOM_POST_TYPE:a="Custom post type";break;case p.TAXONOMY:a="Taxonomy";break;case p.OPTION_PAGE:a="Option page";break;case p.USER:a="All users";break;case p.COMMENT:a="All comments";break;case p.MEDIA:a="Attachment";break;case"POST_ID":a="Post";break;case"POST_TEMPLATE":a="Post template";break;case"POST_TAX":a="Post taxonomy";break;case"POST_CAT":a="Post category";break;case"TERM_ID":a="Term";break;case"USER_ID":a="User";break}return s(a)},l=r=>{if(!r.operator)return"";let a="";switch(r.operator){case"=":a="is equal to";break;case"!=":a="is not equal to";break;case"IN":a="is included in";break;case"NOT_IN":a="is not included in";break}return s(a)},f=r=>{if(!r.find||r.find==="")return"";const a=r.find.split(",");return a.length>0?e.jsx("div",{className:"i-flex-center flex-wrap s-4",children:a.map(o=>e.jsx(F,{belongsTo:r.belongsTo,find:o}))}):""};return e.jsxs(N.Fragment,{children:[e.jsx(C,{title:s("Location"),visible:c,textAlign:"left",children:t.length>0?e.jsx("div",{className:"responsive",children:e.jsx("table",{className:`acpt-table spaceless ${x.is_rtl?"rtl":""}`,children:e.jsx("tbody",{children:t.map((r,a)=>{const o=a===t.length-1;return e.jsxs("tr",{children:[e.jsx("td",{children:i(r)}),e.jsx("td",{children:l(r)}),e.jsx("td",{children:f(r)}),e.jsx("td",{children:!o&&r.logic&&s(r.logic)})]})})})})}):e.jsx(v,{style:h.SECONDARY,children:s("No conditions are present.")})}),e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),n(!c)},children:s("Show")})]})};L.propTypes={belongs:b.array.isRequired};const B=g.memo(({record:t,page:d})=>{const{register:x}=S(),c=`elements.${t.id}`,n=i=>{switch(i){default:case T.STANDARD:return s("Standard view");case T.ACCORDION:return s("Accordion");case T.HORIZONTAL_TABS:return s("Horizontal tabs");case T.VERTICAL_TABS:return s("Vertical tabs")}};return e.jsx(N.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:c,children:[e.jsx("input",{type:"checkbox",id:c,name:c,defaultChecked:!1,...x(c)}),e.jsx("span",{})]})}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.label}),e.jsx("td",{children:n(t.display)}),e.jsx("td",{children:e.jsx(L,{belongs:t.belongs})}),e.jsx("td",{children:t.fieldsCount}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(M,{to:`/edit_meta/${t.id}`,children:s("Edit")}),e.jsx(w,{id:t.id,page:d})]})})]})})});B.propTypes={page:b.number.isRequired,record:b.object.isRequired};const re=()=>{const{control:t,register:d}=S(),x=I({control:t,name:"elements"}),c=()=>{let n=0;for(const[i,l]of Object.entries(x))l===!0&&n++;return n};return e.jsxs("div",{className:"flex-between s-8 mb-24",children:[e.jsxs("span",{children:[c()," ",s("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{name:"action",className:"form-control sm",...d("action"),children:[e.jsx("option",{value:"",children:s("Select")}),e.jsx("option",{value:"delete",children:s("Delete")})]}),e.jsx(O,{style:h.WHITE,size:"sm",children:s("Execute")})]})]})},ae=()=>{const t=document.globals,d=t.settings,x=t.globals,[c]=te(),n=g.useRef(),i=Q({mode:"all"}),l=I({control:i.control,name:"elements"}),f=D(),{data:r,loading:a}=W(u=>u.fetchMeta),{page:o}=V(),A=d.length>0&&E(d,"key","records_per_page")!==""?E(d,"key","records_per_page").value:20,j=Math.ceil(r.count/A);g.useEffect(()=>{z(s("Field groups")),Z("#/meta"),f(R({page:o||1,perPage:A}))},[o]),g.useEffect(()=>{(()=>{if(!l)return!1;let m=0;for(const[ne,Y]of Object.entries(l))Y===!0&&m++;return m===Object.entries(l).length})()?n.current.checked=!0:n.current&&(n.current.checked=!1)},[l]);const y=()=>{if(!l)return!1;for(const[u,m]of Object.entries(l))if(m===!0)return!0;return!1},G=u=>{i.reset(),u.belongsTo=p.META,P("bulkActionsAction",u).then(m=>{if(m.success===!0)switch(u.action){case"delete":k.success(s("Meta group successfully deleted.")),i.resetField("elements"),X(),f(R({page:o||1,perPage:A}));break}else k.error(m.error)}).catch(m=>{console.error(m),k.error(s("Unknown error, please retry later"))})},q=[e.jsx(K,{style:h.PRIMARY,to:"/register_meta",children:s("Create new Meta group")})];return a?e.jsx(J,{}):e.jsx(ee,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(G),children:e.jsxs($,{title:s("Field groups"),actions:q,crumbs:[{label:s("Field groups")}],children:[e.jsx("div",{ref:c,children:y()&&e.jsx(re,{})}),r.records&&r.records.length>0?e.jsx("div",{className:"responsive",children:e.jsxs("table",{className:`acpt-table with-shadow ${x.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"all",children:[e.jsx("input",{ref:n,type:"checkbox",id:"all",defaultChecked:!1,onClick:u=>{r.records.map(m=>{i.setValue(`elements.${m.id}`,u.currentTarget.checked)})}}),e.jsx("span",{})]})}),e.jsx("th",{children:s("Group name")}),e.jsx("th",{children:s("Group label")}),e.jsx("th",{children:s("Display as")}),e.jsx("th",{children:s("Location")}),e.jsx("th",{children:s("Fields count")}),e.jsx("th",{children:s("Actions")})]})}),e.jsx("tbody",{children:r.records&&r.records.map(u=>e.jsx(B,{page:o,record:u},u.id))}),j>1&&e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:e.jsx(se,{currentPage:o?parseInt(o):1,totalPages:j,baseLink:"/meta"})})})})]})}):e.jsxs(v,{style:h.SECONDARY,children:[s("No meta group found.")," ",e.jsx(M,{to:"/register_meta",children:s("Register the first one")}),"!"]})]})})})};ae.propTypes={};export{ae as default};
